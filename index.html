<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è·‘æ­¥æ•°æ®ç»Ÿè®¡å›¾è¡¨</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .stat-card h3 {
            color: #667eea;
            font-size: 0.9em;
            margin-bottom: 10px;
        }
        .stat-card .value {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }
        .stat-card .unit {
            color: #999;
            font-size: 0.9em;
        }
        .chart-full-width {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            width: 100%;
        }
        .chart-full-width h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .chart-full-width .chart-wrapper {
            position: relative;
            height: 400px;
        }
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .chart-container h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .chart-wrapper {
            position: relative;
            height: 350px;
        }
        .data-table {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        .data-table h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }
        tr:hover {
            background: #f8f9ff;
        }
        .highlight {
            background: #fff3cd;
        }
        .filter-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
            align-items: center;
        }
        .filter-container label {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 12px;
            background: #f0f0f0;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9em;
        }
        .filter-container label:hover {
            background: #e0e0e0;
        }
        .filter-container input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }
        .filter-container .color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }
        .filter-actions {
            display: flex;
            gap: 8px;
            margin-left: auto;
        }
        .filter-actions button {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.2s;
        }
        .filter-actions .btn-all {
            background: #667eea;
            color: white;
        }
        .filter-actions .btn-none {
            background: #e0e0e0;
            color: #333;
        }
        .filter-actions button:hover {
            opacity: 0.8;
            transform: scale(1.02);
        }
        .month-filter {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        .month-filter button {
            padding: 8px 20px;
            border: 2px solid #667eea;
            border-radius: 20px;
            background: white;
            color: #667eea;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s;
        }
        .month-filter button:hover {
            background: #f0f0ff;
        }
        .month-filter button.active {
            background: #667eea;
            color: white;
        }
        .medal-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .medal-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .medal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }
        .month-medal-card {
            background: linear-gradient(135deg, #f8f9ff 0%, #fff 100%);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid #e0e0e0;
        }
        .month-medal-card h3 {
            color: #667eea;
            font-size: 1em;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .medal-row {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px dashed #eee;
        }
        .medal-row:last-child {
            border-bottom: none;
        }
        .medal-icon {
            font-size: 1.5em;
            margin-right: 10px;
            width: 30px;
        }
        .medal-name {
            flex: 1;
            font-weight: 500;
            color: #333;
        }
        .medal-distance {
            color: #666;
            font-size: 0.9em;
        }
        .medal-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .medal-summary-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 2px solid #f0f0f0;
            transition: all 0.2s;
        }
        .medal-summary-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .medal-summary-card .name {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }
        .medal-summary-card .medals {
            font-size: 1.2em;
            letter-spacing: 2px;
        }
        .medal-summary-card .total {
            color: #999;
            font-size: 0.8em;
            margin-top: 5px;
        }
        .weekly-goal-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .weekly-goal-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .goal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .goal-card {
            background: linear-gradient(135deg, #e8f5e9 0%, #fff 100%);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 2px solid #c8e6c9;
        }
        .goal-card .name {
            font-weight: 600;
            color: #2e7d32;
            margin-bottom: 8px;
        }
        .goal-card .count {
            font-size: 2em;
            font-weight: bold;
            color: #1b5e20;
        }
        .goal-card .label {
            color: #666;
            font-size: 0.85em;
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .charts-grid {
                grid-template-columns: 1fr;
            }
            h1 {
                font-size: 1.8em;
            }
            .year-summary-section {
                padding: 15px 12px 10px 12px;
                border-radius: 15px;
            }
            .year-summary-section h1 {
                font-size: 1.8em;
                margin-bottom: 10px;
            }
            .year-summary-section .subtitle {
                font-size: 0.95em;
                margin-bottom: 20px;
            }
            .person-selector-container {
                margin-bottom: 25px;
            }
            .person-selector-container select {
                font-size: 1em;
                padding: 12px 20px;
                min-width: 200px;
                max-width: 100%;
            }
            .summary-cards-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            .year-summary-card {
                padding: 15px 10px;
            }
            .year-summary-card .icon {
                font-size: 2em;
            }
            .year-summary-card .label {
                font-size: 0.8em;
            }
            .year-summary-card .value {
                font-size: 1.6em;
            }
            .year-summary-card .unit {
                font-size: 0.75em;
            }
            .milestone-section, .encouragement-section, .highlight-moments, .monthly-chart-container {
                padding: 15px;
                margin-bottom: 15px;
            }
            .milestone-section h3, .encouragement-section h3, .highlight-moments h3, .monthly-chart-container h3 {
                font-size: 1.3em;
                margin-bottom: 15px;
            }
            .landmark-comparison, .earth-progress-container {
                padding: 15px;
            }
            .landmark-comparison .distance-highlight {
                font-size: 1.5em;
            }
            .landmark-comparison .comparison-text {
                font-size: 1em;
            }
            .encouragement-text {
                font-size: 0.95em;
                line-height: 1.6;
            }
            .highlight-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            .highlight-item {
                padding: 15px 10px;
            }
            .highlight-item .icon {
                font-size: 1.5em;
            }
            .highlight-item .title {
                font-size: 0.8em;
            }
            .highlight-item .value {
                font-size: 1.4em;
            }
        }
        .collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        .collapsible-header h2 {
            margin-bottom: 0;
            border-bottom: none;
            padding-bottom: 0;
        }
        .collapsible-header .toggle-icon {
            font-size: 1.5em;
            transition: transform 0.3s;
        }
        .collapsible-header.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }
        .collapsible-content {
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .collapsible-content.collapsed {
            max-height: 0 !important;
        }
        .export-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 1em;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: all 0.3s;
            z-index: 1000;
        }
        .export-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
        }
        .export-btn:active {
            transform: translateY(0);
        }
        .person-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }
        .person-filter button {
            padding: 6px 14px;
            border: 2px solid #667eea;
            border-radius: 20px;
            background: white;
            color: #667eea;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.2s;
        }
        .person-filter button:hover {
            background: #f0f0ff;
        }
        .person-filter button.active {
            background: #667eea;
            color: white;
        }
        .add-data-btn {
            position: fixed;
            bottom: 30px;
            right: 150px;
            background: linear-gradient(135deg, #1ABC9C 0%, #16A085 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 1em;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: all 0.3s;
            z-index: 1000;
        }
        .add-data-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
        }
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        .modal-overlay.active {
            display: flex;
        }
        .modal {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .modal.wide {
            max-width: 700px;
        }
        .modal h2 {
            color: #333;
            margin-bottom: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .modal-close {
            float: right;
            font-size: 1.5em;
            cursor: pointer;
            color: #999;
            line-height: 1;
        }
        .modal-close:hover {
            color: #333;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.2s;
        }
        .form-group textarea {
            font-family: monospace;
            resize: vertical;
            min-height: 150px;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        .form-actions button {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-primary {
            background: #667eea;
            color: white;
        }
        .btn-primary:hover {
            background: #5568d6;
        }
        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }
        .btn-secondary:hover {
            background: #d0d0d0;
        }
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        .btn-danger:hover {
            background: #c0392b;
        }
        .copy-success {
            color: #1ABC9C;
            font-weight: 600;
            margin-top: 10px;
            display: none;
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(102, 126, 234, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        .loading-overlay.hidden {
            display: none;
        }
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .loading-text {
            color: white;
            margin-top: 20px;
            font-size: 1.2em;
        }
        .config-btn {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            font-size: 0.9em;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: all 0.3s;
            z-index: 1000;
        }
        .config-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
        }
        .batch-import-btn {
            position: fixed;
            bottom: 30px;
            right: 270px;
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 1em;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            transition: all 0.3s;
            z-index: 1000;
        }
        .batch-import-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
        }
        .import-preview {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
        }
        .import-preview-item {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
            font-size: 0.9em;
        }
        .import-preview-item:last-child {
            border-bottom: none;
        }
        .import-preview-item.valid {
            color: #27ae60;
        }
        .import-preview-item.invalid {
            color: #e74c3c;
        }
        .import-stats {
            display: flex;
            gap: 15px;
            margin-top: 10px;
            padding: 10px;
            background: #e8f5e9;
            border-radius: 8px;
        }
        .import-stats span {
            font-weight: 600;
        }
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        /* å¹´ç»ˆæ€»ç»“æ ·å¼ */
        .year-summary-section {
            background: linear-gradient(135deg, #FFA726 0%, #FB8C00 50%, #F57C00 100%);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            color: white;
        }
        .year-summary-section h1 {
            text-align: center;
            font-size: 2.8em;
            margin-bottom: 15px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
        }
        .year-summary-section .subtitle {
            text-align: center;
            font-size: 1.2em;
            margin-bottom: 30px;
            opacity: 0.95;
        }
        .person-selector-container {
            text-align: center;
            margin-bottom: 40px;
        }
        .person-selector-container select {
            font-size: 1.3em;
            padding: 15px 30px;
            border-radius: 50px;
            border: 3px solid white;
            background: rgba(255,255,255,0.95);
            color: #F57C00;
            font-weight: bold;
            cursor: pointer;
            min-width: 280px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }
        .person-selector-container select:hover {
            transform: scale(1.05);
            background: white;
        }
        .year-summary-content {
            display: none;
        }
        .year-summary-content.active {
            display: block;
            animation: fadeIn 0.6s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .summary-cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }
        .year-summary-card {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            transition: transform 0.3s;
        }
        .year-summary-card:hover {
            transform: translateY(-5px);
        }
        .year-summary-card .icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .year-summary-card .label {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 8px;
        }
        .year-summary-card .value {
            color: #F57C00;
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .year-summary-card .unit {
            color: #999;
            font-size: 0.85em;
        }
        .milestone-section {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            color: #333;
        }
        .milestone-section h3 {
            color: #F57C00;
            font-size: 1.6em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .landmark-comparison {
            background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #2196F3;
        }
        .landmark-comparison .distance-highlight {
            font-size: 2em;
            font-weight: bold;
            color: #1976D2;
            margin-bottom: 15px;
        }
        .landmark-comparison .comparison-text {
            font-size: 1.15em;
            color: #424242;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        .earth-progress-container {
            background: linear-gradient(135deg, #C8E6C9 0%, #A5D6A7 100%);
            border-radius: 12px;
            padding: 25px;
            border-left: 5px solid #4CAF50;
        }
        .earth-progress-container h4 {
            color: #2E7D32;
            font-size: 1.3em;
            margin-bottom: 15px;
        }
        .progress-ring {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 20px auto;
        }
        .progress-ring svg {
            transform: rotate(-90deg);
        }
        .progress-ring-circle {
            fill: none;
            stroke: #E8F5E9;
            stroke-width: 12;
        }
        .progress-ring-progress {
            fill: none;
            stroke: #4CAF50;
            stroke-width: 12;
            stroke-linecap: round;
            transition: stroke-dashoffset 1s ease;
        }
        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
        .progress-text .percentage {
            font-size: 2.5em;
            font-weight: bold;
            color: #2E7D32;
        }
        .progress-text .label {
            font-size: 0.9em;
            color: #666;
        }
        .earth-stats {
            text-align: center;
            font-size: 1.1em;
            color: #424242;
            margin-top: 15px;
        }
        .encouragement-section {
            background: linear-gradient(135deg, #FFE0B2 0%, #FFCC80 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            border-left: 5px solid #FF9800;
        }
        .encouragement-section h3 {
            color: #E65100;
            font-size: 1.6em;
            margin-bottom: 20px;
        }
        .encouragement-text {
            font-size: 1.2em;
            line-height: 1.8;
            color: #424242;
            margin-bottom: 15px;
        }
        .encouragement-text .highlight {
            color: #E65100;
            font-weight: bold;
        }
        .monthly-chart-container {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
        }
        .monthly-chart-container h3 {
            color: #F57C00;
            font-size: 1.5em;
            margin-bottom: 20px;
        }
        .monthly-chart-wrapper {
            position: relative;
            height: 350px;
        }
        .highlight-moments {
            background: linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 100%);
            border-radius: 15px;
            padding: 30px;
            border-left: 5px solid #9C27B0;
        }
        .highlight-moments h3 {
            color: #6A1B9A;
            font-size: 1.6em;
            margin-bottom: 20px;
        }
        .highlight-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .highlight-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .highlight-item .icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        .highlight-item .title {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 8px;
        }
        .highlight-item .value {
            color: #9C27B0;
            font-size: 1.8em;
            font-weight: bold;
        }
        .status-connected {
            background: #27ae60;
        }
        .status-disconnected {
            background: #e74c3c;
        }
        .connection-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 8px 15px;
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-size: 0.85em;
            z-index: 1000;
        }
        .format-help {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 15px;
            font-size: 0.85em;
        }
        .format-help code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 10px 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container" id="mainContainer">
        <h1>ğŸƒ 2025å¹´è·‘æ­¥æ•°æ®ç»Ÿè®¡</h1>

        <div class="stats-summary" id="statsSummary"></div>

        <div class="chart-full-width">
            <h2>ğŸ“… æ¯å‘¨è·‘æ­¥é‡Œç¨‹ç»Ÿè®¡ï¼ˆå †ç§¯å›¾ï¼‰</h2>
            <div id="stackedFilter" class="filter-container"></div>
            <div class="chart-wrapper">
                <canvas id="weeklyStackedChart"></canvas>
            </div>
        </div>

        <div class="weekly-goal-section">
            <h2>ğŸ¯ æ¯å‘¨è¾¾æ ‡ç»Ÿè®¡ï¼ˆå‘¨ç›®æ ‡: 3km+ï¼‰</h2>
            <div class="goal-grid" id="weeklyGoalStats"></div>
        </div>

        <div class="medal-section">
            <h2>ğŸ† æœˆåº¦é‡Œç¨‹æ’è¡Œæ¦œ</h2>
            <div class="medal-grid" id="monthlyMedals"></div>
            <h3 style="margin-top: 25px; color: #333; border-bottom: 1px solid #eee; padding-bottom: 10px;">å¥–ç‰Œæ€»æ¦œ</h3>
            <div class="medal-summary" id="medalSummary"></div>
        </div>

        <div class="chart-full-width">
            <h2>ğŸ“ˆ æ¯å‘¨ä¸ªäººè·‘æ­¥è·ç¦»å˜åŒ–</h2>
            <div id="trendFilter" class="filter-container"></div>
            <div class="chart-wrapper">
                <canvas id="weeklyTrendChart"></canvas>
            </div>
        </div>

        <div class="charts-grid">
            <div class="chart-container">
                <h2>ğŸ“Š ä¸ªäººæ€»é‡Œç¨‹æ’è¡Œ</h2>
                <div class="chart-wrapper">
                    <canvas id="totalDistanceChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <h2>ğŸ¯ ä¸ªäººè·‘æ­¥æ¬¡æ•°</h2>
                <div class="chart-wrapper">
                    <canvas id="runCountChart"></canvas>
                </div>
            </div>
        </div>

        <!-- 2025å¹´ç»ˆæ€»ç»“æ¨¡å— -->
        <div class="year-summary-section" id="yearSummarySection">
            <h1>ğŸŠ ITCCCè·‘å›¢ 2025å¹´ç»ˆæ€»ç»“ ğŸŠ</h1>
            <div class="subtitle">å›é¡¾è¿™ä¸€å¹´çš„åšæŒä¸çªç ´ï¼Œæ¯ä¸€æ­¥éƒ½å€¼å¾—éª„å‚²ï¼</div>

            <div class="person-selector-container">
                <select id="yearSummarySelector" onchange="showYearSummary()">
                    <option value="">ğŸƒ é€‰æ‹©ä½ çš„åå­—ï¼ŒæŸ¥çœ‹ä¸“å±å¹´ç»ˆæŠ¥å‘Š ğŸƒ</option>
                </select>
            </div>

            <div id="yearSummaryContent" class="year-summary-content">
                <!-- åŸºç¡€æˆå°±å¡ç‰‡ -->
                <div class="summary-cards-grid">
                    <div class="year-summary-card">
                        <div class="icon">ğŸ†</div>
                        <div class="label">å¹´åº¦æ€»é‡Œç¨‹</div>
                        <div class="value" id="totalDistanceValue">0</div>
                        <div class="unit">å…¬é‡Œ</div>
                    </div>
                    <div class="year-summary-card">
                        <div class="icon">ğŸ”¥</div>
                        <div class="label">è·‘æ­¥æ€»æ¬¡æ•°</div>
                        <div class="value" id="totalRunsValue">0</div>
                        <div class="unit">æ¬¡</div>
                    </div>
                    <div class="year-summary-card">
                        <div class="icon">ğŸ“…</div>
                        <div class="label">æ´»è·ƒæœˆä»½æ•°</div>
                        <div class="value" id="activeMonthsValue">0</div>
                        <div class="unit">ä¸ªæœˆ</div>
                    </div>
                    <div class="year-summary-card">
                        <div class="icon">ğŸ’ª</div>
                        <div class="label">å¹³å‡æ¯æ¬¡</div>
                        <div class="value" id="avgDistanceValue">0</div>
                        <div class="unit">å…¬é‡Œ</div>
                    </div>
                    <div class="year-summary-card">
                        <div class="icon">ğŸš€</div>
                        <div class="label">å•æ¬¡æœ€é•¿</div>
                        <div class="value" id="maxDistanceValue">0</div>
                        <div class="unit">å…¬é‡Œ</div>
                    </div>
                </div>

                <!-- é‡Œç¨‹ç¢‘å¯¹æ¯” -->
                <div class="milestone-section">
                    <h3>ğŸ—ºï¸ ä½ çš„è·‘æ­¥æ—…ç¨‹</h3>
                    <div class="landmark-comparison">
                        <div class="distance-highlight" id="landmarkDistance">0 å…¬é‡Œ</div>
                        <div class="comparison-text" id="landmarkText">åŠ è½½ä¸­...</div>
                    </div>

                    <!-- åœ°çƒå‘¨é•¿è¿›åº¦ -->
                    <div class="earth-progress-container">
                        <h4>ğŸŒ ç¯çƒæ¢¦æƒ³è¿›åº¦</h4>
                        <div class="progress-ring">
                            <svg width="200" height="200">
                                <circle class="progress-ring-circle" cx="100" cy="100" r="85"></circle>
                                <circle class="progress-ring-progress" id="earthProgressCircle" cx="100" cy="100" r="85"></circle>
                            </svg>
                            <div class="progress-text">
                                <div class="percentage" id="earthPercentage">0%</div>
                                <div class="label">å·²å®Œæˆ</div>
                            </div>
                        </div>
                        <div class="earth-stats" id="earthStats">
                            åœ°çƒèµ¤é“å‘¨é•¿ 40,075 å…¬é‡Œ<br>
                            æŒ‰æ­¤é€Ÿåº¦ï¼Œå†è·‘ <span style="font-weight: bold; color: #2E7D32;" id="yearsToEarth">-</span> å¹´å¯ç»•åœ°çƒä¸€åœˆï¼
                        </div>
                    </div>
                </div>

                <!-- æœˆåº¦è¶‹åŠ¿å›¾ -->
                <div class="monthly-chart-container">
                    <h3>ğŸ“Š ä½ çš„æœˆåº¦é‡Œç¨‹å˜åŒ–</h3>
                    <div class="monthly-chart-wrapper">
                        <canvas id="personalMonthlyChart"></canvas>
                    </div>
                </div>

                <!-- é«˜å…‰æ—¶åˆ» -->
                <div class="highlight-moments">
                    <h3>âœ¨ é«˜å…‰æ—¶åˆ»å›é¡¾</h3>
                    <div class="highlight-grid">
                        <div class="highlight-item">
                            <div class="icon">ğŸ–ï¸</div>
                            <div class="title">è·å¾—å¥–ç‰Œ</div>
                            <div class="value" id="medalCount">0</div>
                        </div>
                        <div class="highlight-item">
                            <div class="icon">ğŸ¯</div>
                            <div class="title">è¾¾æ ‡å‘¨æ•°</div>
                            <div class="value" id="goalWeeks">0</div>
                        </div>
                        <div class="highlight-item">
                            <div class="icon">ğŸ“ˆ</div>
                            <div class="title">æœ€ä½³æœˆä»½</div>
                            <div class="value" id="bestMonth">-</div>
                        </div>
                        <div class="highlight-item">
                            <div class="icon">ğŸ”¥</div>
                            <div class="title">æœ€æ´»è·ƒæœˆ</div>
                            <div class="value" id="mostActiveMonth">-</div>
                        </div>
                    </div>
                </div>

                <!-- å½©è™¹å±åŒºåŸŸ -->
                <div class="encouragement-section">
                    <h3>ğŸŒˆ ä¸“å±å¯„è¯­</h3>
                    <div id="encouragementTexts"></div>
                </div>

                <!-- å¯¼å‡ºæŒ‰é’® -->
                <div style="text-align: center; margin-top: 30px;">
                    <button onclick="exportYearSummary()" style="
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border: none;
                        padding: 15px 40px;
                        border-radius: 50px;
                        font-size: 1.1em;
                        font-weight: bold;
                        cursor: pointer;
                        box-shadow: 0 5px 20px rgba(0,0,0,0.3);
                        transition: all 0.3s;
                    " onmouseover="this.style.transform='translateY(-3px)'" onmouseout="this.style.transform='translateY(0)'">
                        ğŸ“¸ å¯¼å‡ºæˆ‘çš„å¹´ç»ˆæ€»ç»“
                    </button>
                </div>
            </div>
        </div>

        <div class="data-table">
            <div class="collapsible-header collapsed" onclick="toggleDataTable()">
                <h2>ğŸ“‹ å®Œæ•´æ•°æ®è®°å½•</h2>
                <span class="toggle-icon">â–¼</span>
            </div>
            <div class="collapsible-content collapsed" id="dataTableContent">
                <div style="border-top: 2px solid #667eea; margin-top: 10px; padding-top: 20px;">
                    <div id="monthFilter" class="month-filter"></div>
                    <div id="personFilter" class="person-filter"></div>
                    <table id="dataTable">
                        <thead>
                            <tr>
                                <th>åºå·</th>
                                <th>å§“å</th>
                                <th>æ—¥æœŸ</th>
                                <th>è·ç¦» (km)</th>
                                <th>å¤‡æ³¨</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>

        <button class="add-data-btn" onclick="openAddDataModal()">+ æ·»åŠ æ•°æ®</button>
        <button class="batch-import-btn" onclick="openBatchImportModal()">ğŸ“¥ æ‰¹é‡å¯¼å…¥</button>
        <button class="export-btn" onclick="exportToImage()">ğŸ“· å¯¼å‡ºå›¾ç‰‡</button>
        <button class="config-btn" onclick="openConfigModal()">âš™ï¸ é…ç½®</button>
    </div>

    <!-- è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨ -->
    <div class="connection-status" id="connectionStatus">
        <span class="status-indicator status-disconnected" id="statusIndicator"></span>
        <span id="statusText">æœªè¿æ¥</span>
    </div>

    <!-- åŠ è½½ä¸­é®ç½© -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loadingText">åŠ è½½æ•°æ®ä¸­...</div>
    </div>

    <!-- æ·»åŠ æ•°æ®å¼¹çª— -->
    <div class="modal-overlay" id="addDataModal">
        <div class="modal">
            <span class="modal-close" onclick="closeAddDataModal()">&times;</span>
            <h2>æ·»åŠ è·‘æ­¥æ•°æ®</h2>
            <div class="form-group">
                <label>å§“å</label>
                <select id="inputName">
                    <option value="">-- é€‰æ‹©æˆ–è¾“å…¥æ–°åå­— --</option>
                </select>
            </div>
            <div class="form-group">
                <label>æˆ–è¾“å…¥æ–°åå­—</label>
                <input type="text" id="inputNewName" placeholder="å¦‚æœæ˜¯æ–°æˆå‘˜ï¼Œåœ¨æ­¤è¾“å…¥">
            </div>
            <div class="form-group">
                <label>æ—¥æœŸ</label>
                <input type="date" id="inputDate" value="">
            </div>
            <div class="form-group">
                <label>è·ç¦» (km)</label>
                <input type="number" id="inputDistance" step="0.01" min="0" placeholder="ä¾‹å¦‚: 5.5">
            </div>
            <div class="form-group">
                <label>å¤‡æ³¨ (å¯é€‰)</label>
                <input type="text" id="inputNote" placeholder="ä¾‹å¦‚: w10">
            </div>
            <div class="form-actions">
                <button class="btn-secondary" onclick="closeAddDataModal()">å–æ¶ˆ</button>
                <button class="btn-primary" id="saveDataBtn" onclick="saveData()">ä¿å­˜æ•°æ®</button>
            </div>
            <div class="success-message" id="addSuccess">æ•°æ®æ·»åŠ æˆåŠŸ!</div>
            <div class="error-message" id="addError"></div>
        </div>
    </div>

    <!-- æ‰¹é‡å¯¼å…¥å¼¹çª— -->
    <div class="modal-overlay" id="batchImportModal">
        <div class="modal wide">
            <span class="modal-close" onclick="closeBatchImportModal()">&times;</span>
            <h2>æ‰¹é‡å¯¼å…¥æ•°æ®</h2>
            <div class="format-help">
                <strong>æ ¼å¼è¯´æ˜ï¼š</strong>æ¯è¡Œä¸€æ¡æ•°æ®ï¼Œä½¿ç”¨é€—å·æˆ–ç©ºæ ¼åˆ†éš”<br>
                æ ¼å¼: <code>å§“å, æ—¥æœŸ(MMDDæˆ–MM-DDæˆ–MæœˆDæ—¥), è·ç¦», å¤‡æ³¨(å¯é€‰)</code><br>
                ç¤ºä¾‹:<br>
                <code>å¾å²š, 1220, 5.5</code><br>
                <code>æ–¹æ–‡, 12-21, 10, å‘¨æœ«è®­ç»ƒ</code><br>
                <code>æ¢æ™¨, 12æœˆ22æ—¥, 3.5</code>
            </div>
            <div class="form-group">
                <label>æ‰¹é‡æ•°æ®</label>
                <textarea id="batchInput" placeholder="ç²˜è´´æ•°æ®åˆ°è¿™é‡Œï¼Œæ¯è¡Œä¸€æ¡..."></textarea>
            </div>
            <button class="btn-secondary" onclick="previewBatchData()" style="width: 100%; margin-bottom: 10px;">é¢„è§ˆæ•°æ®</button>
            <div id="batchPreview" class="import-preview" style="display: none;"></div>
            <div id="batchStats" class="import-stats" style="display: none;"></div>
            <div class="form-actions">
                <button class="btn-secondary" onclick="closeBatchImportModal()">å–æ¶ˆ</button>
                <button class="btn-primary" id="batchImportBtn" onclick="executeBatchImport()" disabled>å¯¼å…¥æ•°æ®</button>
            </div>
            <div class="success-message" id="batchSuccess"></div>
            <div class="error-message" id="batchError"></div>
        </div>
    </div>

    <!-- é…ç½®å¼¹çª— -->
    <div class="modal-overlay" id="configModal">
        <div class="modal">
            <span class="modal-close" onclick="closeConfigModal()">&times;</span>
            <h2>Supabase é…ç½®</h2>
            <div class="format-help">
                <strong>è®¾ç½®è¯´æ˜ï¼š</strong><br>
                1. ç™»å½• <a href="https://supabase.com" target="_blank">Supabase</a> åˆ›å»ºé¡¹ç›®<br>
                2. åœ¨ Settings > API ä¸­è·å– URL å’Œ anon key<br>
                3. åœ¨ SQL Editor ä¸­è¿è¡Œä»¥ä¸‹SQLåˆ›å»ºè¡¨ï¼š
                <pre style="background: #f8f9fa; padding: 10px; margin-top: 10px; border-radius: 4px; font-size: 0.8em; overflow-x: auto;">
CREATE TABLE running_records (
  id SERIAL PRIMARY KEY,
  name TEXT NOT NULL,
  date TEXT NOT NULL,
  distance NUMERIC NOT NULL,
  unit TEXT DEFAULT 'km',
  note TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- å…è®¸åŒ¿åè®¿é—®
ALTER TABLE running_records ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Allow all" ON running_records FOR ALL USING (true);</pre>
            </div>
            <div class="form-group">
                <label>Supabase URL</label>
                <input type="text" id="supabaseUrl" placeholder="https://xxx.supabase.co">
            </div>
            <div class="form-group">
                <label>Supabase Anon Key</label>
                <input type="password" id="supabaseKey" placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6...">
            </div>
            <div class="form-actions">
                <button class="btn-secondary" onclick="closeConfigModal()">å–æ¶ˆ</button>
                <button class="btn-primary" onclick="saveConfig()">ä¿å­˜é…ç½®</button>
            </div>
            <div class="success-message" id="configSuccess">é…ç½®ä¿å­˜æˆåŠŸ!</div>
            <div class="error-message" id="configError"></div>
            <hr style="margin: 20px 0; border: none; border-top: 1px solid #eee;">
            <button class="btn-danger" onclick="clearConfig()" style="width: 100%;">æ¸…é™¤é…ç½®ï¼ˆä½¿ç”¨æœ¬åœ°æ•°æ®ï¼‰</button>
        </div>
    </div>

    <script>
        // ============== Supabase é…ç½® ==============
        let supabaseClient = null;
        let isConnected = false;

        // æœ¬åœ°å¤‡ä»½æ•°æ®
        const localData = [
            // 1æœˆæ•°æ®
            { id: 1, name: 'æ¨é–', date: '0114', distance: 6, unit: 'km' },
            { id: 2, name: 'é™ˆå³¥åµ˜', date: '0114', distance: 1, unit: 'km' },
            { id: 3, name: 'å¾å²š', date: '0114', distance: 6.5, unit: 'km' },
            { id: 4, name: 'é©¬æ–‡é›…', date: '0115', distance: 2, unit: 'km' },
            { id: 5, name: 'é™ˆå³¥åµ˜', date: '0115', distance: 3, unit: 'km', note: 'w1' },
            { id: 6, name: 'æ¢æ™¨', date: '0116', distance: 2, unit: 'km' },
            { id: 7, name: 'chuchu', date: '0116', distance: 4.11, unit: 'km' },
            { id: 8, name: 'é™ˆå³¥åµ˜', date: '0115', distance: 1, unit: 'km', note: 'w1' },
            { id: 9, name: 'å¾å²š', date: '0116', distance: 7, unit: 'km' },
            { id: 10, name: 'æ–¹æ–‡', date: '0116', distance: 5, unit: 'km' },
            { id: 11, name: 'é©¬æ–‡é›…', date: '0117', distance: 2, unit: 'km' },
            { id: 12, name: 'chuchu', date: '0117', distance: 4.5, unit: 'km' },
            { id: 13, name: 'å¾å²š', date: '0117', distance: 10.5, unit: 'km' },
            { id: 14, name: 'æ¢æ™¨', date: '0117', distance: 2, unit: 'km' },
            { id: 15, name: 'å¾å²š', date: '0119', distance: 11.5, unit: 'km' },
            { id: 16, name: 'å¾å²š', date: '0121', distance: 7.37, unit: 'km' },
            { id: 17, name: 'é©¬æ–‡é›…', date: '0121', distance: 3.7, unit: 'km' },
            { id: 18, name: 'æ–¹æ–‡', date: '0121', distance: 2, unit: 'km' },
            { id: 19, name: 'chuchu', date: '0122', distance: 4.47, unit: 'km' },
            { id: 20, name: 'é©¬æ–‡é›…', date: '0122', distance: 3, unit: 'km' },
            { id: 21, name: 'æ¢æ™¨', date: '0122', distance: 2, unit: 'km' },
            { id: 22, name: 'chuchu', date: '0123', distance: 4.55, unit: 'km' },
            { id: 23, name: 'æ¨é–', date: '0123', distance: 6.75, unit: 'km' },
            { id: 24, name: 'å¾å²š', date: '0123', distance: 10.14, unit: 'km' },
            { id: 25, name: 'é™ˆå³¥åµ˜', date: '0123', distance: 1.5, unit: 'km', note: 'w4' },
            { id: 26, name: 'å¾å²š', date: '0124', distance: 7.04, unit: 'km' },
            { id: 27, name: 'é™ˆå³¥åµ˜', date: '0125', distance: 1, unit: 'km', note: 'w4' },
            { id: 28, name: 'å¾å²š', date: '0126', distance: 9.2, unit: 'km' },
            { id: 29, name: 'æ¢æ™¨', date: '0126', distance: 1.79, unit: 'km' },
            { id: 30, name: 'æ–¹æ–‡', date: '0126', distance: 5, unit: 'km' },
            { id: 31, name: 'é™ˆå³¥åµ˜', date: '0128', distance: 1, unit: 'km', note: 'w5' },
            { id: 32, name: 'å¾å²š', date: '0128', distance: 6.87, unit: 'km' },
            { id: 33, name: 'é™ˆå³¥åµ˜', date: '0129', distance: 1, unit: 'km', note: 'w5' },
            { id: 34, name: 'æ¢æ™¨', date: '0129', distance: 1.5, unit: 'km' },
            { id: 35, name: 'chuchu', date: '0130', distance: 3.38, unit: 'km' },
            { id: 36, name: 'å¾å²š', date: '0130', distance: 7.19, unit: 'km' },
            { id: 37, name: 'å¾å²š', date: '0131', distance: 6.77, unit: 'km' },
            // 2æœˆæ•°æ®
            { id: 38, name: 'æ–¹æ–‡', date: '0201', distance: 6, unit: 'km' },
            { id: 39, name: 'é™ˆå³¥åµ˜', date: '0201', distance: 1.5, unit: 'km', note: 'w5' },
            { id: 40, name: 'é©¬æ–‡é›…', date: '0201', distance: 4.17, unit: 'km' },
            { id: 41, name: 'é©¬æ–‡é›…', date: '0202', distance: 2.31, unit: 'km' },
            { id: 42, name: 'æ¨é–', date: '0202', distance: 6, unit: 'km' },
            { id: 43, name: 'å¾å²š', date: '0202', distance: 7.6, unit: 'km' },
            { id: 44, name: 'æ¢æ™¨', date: '0202', distance: 1.75, unit: 'km' },
            { id: 45, name: 'é™ˆå³¥åµ˜', date: '0202', distance: 3, unit: 'km', note: 'w5' },
            { id: 46, name: 'å¾å²š', date: '0204', distance: 9.55, unit: 'km' },
            { id: 47, name: 'chuchu', date: '0205', distance: 3.49, unit: 'km' },
            { id: 48, name: 'å¾å²š', date: '0206', distance: 6.77, unit: 'km' },
            { id: 49, name: 'é™ˆå³¥åµ˜', date: '0206', distance: 1.5, unit: 'km', note: 'w5' },
            { id: 50, name: 'æ¨é–', date: '0206', distance: 6, unit: 'km' },
            { id: 51, name: 'å¾å²š', date: '0207', distance: 7.7, unit: 'km' },
            { id: 52, name: 'æ¢æ™¨', date: '0207', distance: 2, unit: 'km' },
            { id: 53, name: 'æ¢æ™¨', date: '0208', distance: 1.4, unit: 'km' },
            { id: 54, name: 'é©¬æ–‡é›…', date: '0208', distance: 2, unit: 'km' },
            { id: 55, name: 'chuchu', date: '0209', distance: 4.45, unit: 'km' },
            { id: 56, name: 'å¾å²š', date: '0209', distance: 12.25, unit: 'km' },
            { id: 57, name: 'æ–¹æ–‡', date: '0209', distance: 5, unit: 'km' },
            { id: 58, name: 'é©¬æ–‡é›…', date: '0211', distance: 3, unit: 'km' },
            { id: 59, name: 'å¾å²š', date: '0211', distance: 11.14, unit: 'km' },
            { id: 60, name: 'chuchu', date: '0212', distance: 5.12, unit: 'km' },
            { id: 61, name: 'æ¨é–', date: '0212', distance: 6, unit: 'km' },
            { id: 62, name: 'é™ˆå³¥åµ˜', date: '0213', distance: 3, unit: 'km', note: 'w7' },
            { id: 63, name: 'å¾å²š', date: '0213', distance: 10.06, unit: 'km' },
            { id: 64, name: 'æ–¹æ–‡', date: '0213', distance: 1.6, unit: 'km' },
            { id: 65, name: 'é©¬æ–‡é›…', date: '0214', distance: 2.9, unit: 'km' },
            { id: 66, name: 'æ¢æ™¨', date: '0214', distance: 2.6, unit: 'km' },
            { id: 67, name: 'å¾å²š', date: '0214', distance: 9, unit: 'km' },
            { id: 68, name: 'é™ˆå³¥åµ˜', date: '0214', distance: 3.2, unit: 'km', note: 'w7' },
            { id: 69, name: 'æ–¹æ–‡', date: '0215', distance: 7, unit: 'km' },
            { id: 70, name: 'é©¬æ–‡é›…', date: '0215', distance: 4, unit: 'km' },
            { id: 71, name: 'å¾å²š', date: '0216', distance: 8.66, unit: 'km' },
            { id: 72, name: 'æ¢æ™¨', date: '0216', distance: 1.5, unit: 'km' },
            { id: 73, name: 'æ¨é–', date: '0216', distance: 6, unit: 'km' },
            { id: 74, name: 'é™ˆå³¥åµ˜', date: '0216', distance: 5, unit: 'km', note: 'w7' },
            { id: 75, name: 'å¼ åª›åª›', date: '0216', distance: 3.02, unit: 'km' },
            { id: 76, name: 'é™ˆå¾·ç´', date: '0214', distance: 3.18, unit: 'km' },
            { id: 77, name: 'chuchu', date: '0217', distance: 4.36, unit: 'km' },
            { id: 78, name: 'é™ˆå¾·ç´', date: '0215', distance: 1.3, unit: 'km' },
            { id: 79, name: 'é™ˆå¾·ç´', date: '0216', distance: 2.33, unit: 'km' },
            { id: 80, name: 'å¾å²š', date: '0218', distance: 10.59, unit: 'km' },
            { id: 81, name: 'é™ˆå¾·ç´', date: '0217', distance: 2.18, unit: 'km' },
            { id: 82, name: 'æ–¹æ–‡', date: '0218', distance: 5, unit: 'km' },
            { id: 83, name: 'é™ˆå¾·ç´', date: '0219', distance: 3.25, unit: 'km' },
            { id: 84, name: 'chuchu', date: '0219', distance: 5, unit: 'km' },
            { id: 85, name: 'é™ˆå³¥åµ˜', date: '0219', distance: 3, unit: 'km', note: 'w8' },
            { id: 86, name: 'æ¨é–', date: '0219', distance: 6, unit: 'km' },
            { id: 87, name: 'é™ˆå¾·ç´', date: '0220', distance: 4.09, unit: 'km' },
            { id: 88, name: 'é™ˆå³¥åµ˜', date: '0220', distance: 3, unit: 'km', note: 'w8' },
            { id: 89, name: 'å¾å²š', date: '0220', distance: 9.52, unit: 'km' },
            { id: 90, name: 'æ–¹æ–‡', date: '0220', distance: 2, unit: 'km' },
            { id: 91, name: 'é©¬æ–‡é›…', date: '0221', distance: 2, unit: 'km' },
            { id: 92, name: 'å¾å²š', date: '0221', distance: 10.10, unit: 'km' },
            { id: 93, name: 'æ–¹æ–‡', date: '0222', distance: 8, unit: 'km' },
            { id: 94, name: 'é©¬æ–‡é›…', date: '0222', distance: 5, unit: 'km' },
            { id: 95, name: 'å¼ åª›åª›', date: '0222', distance: 4.08, unit: 'km' },
            { id: 96, name: 'æ¢æ™¨', date: '0223', distance: 3, unit: 'km' },
            { id: 97, name: 'chuchu', date: '0224', distance: 5.26, unit: 'km' },
            { id: 98, name: 'å¾å²š', date: '0223', distance: 13.06, unit: 'km' },
            { id: 99, name: 'å¾å²š', date: '0225', distance: 7.5, unit: 'km' },
            { id: 100, name: 'é©¬æ–‡é›…', date: '0225', distance: 3, unit: 'km' },
            { id: 101, name: 'é™ˆå¾·ç´', date: '0225', distance: 4.12, unit: 'km' },
            { id: 102, name: 'æ–¹æ–‡', date: '0225', distance: 5, unit: 'km' },
            { id: 103, name: 'chuchu', date: '0226', distance: 6.30, unit: 'km' },
            { id: 104, name: 'æ¢æ™¨', date: '0226', distance: 2, unit: 'km' },
            { id: 105, name: 'å¾å²š', date: '0227', distance: 9.34, unit: 'km' },
            { id: 106, name: 'æ¨é–', date: '0227', distance: 6, unit: 'km' },
            { id: 107, name: 'é©¬æ–‡é›…', date: '0227', distance: 3, unit: 'km' },
            { id: 108, name: 'é™ˆå¾·ç´', date: '0227', distance: 3, unit: 'km' },
            { id: 109, name: 'æ–¹æ–‡', date: '0227', distance: 2, unit: 'km' },
            { id: 110, name: 'chuchu', date: '0228', distance: 4.38, unit: 'km' },
            { id: 111, name: 'é™ˆå¾·ç´', date: '0228', distance: 2.37, unit: 'km' },
            { id: 112, name: 'å¾å²š', date: '0228', distance: 10.38, unit: 'km' },
            // 3æœˆæ•°æ®
            { id: 113, name: 'å¼ åª›åª›', date: '0301', distance: 3.11, unit: 'km' },
            { id: 114, name: 'é™ˆå¾·ç´', date: '0301', distance: 5.29, unit: 'km' },
            { id: 115, name: 'é™ˆå³¥åµ˜', date: '0301', distance: 3.91, unit: 'km' },
            { id: 116, name: 'æ–¹æ–‡', date: '0301', distance: 12, unit: 'km' },
            { id: 117, name: 'é©¬æ–‡é›…', date: '0301', distance: 2.2, unit: 'km' },
            { id: 118, name: 'å¾å²š', date: '0302', distance: 14, unit: 'km' },
            { id: 119, name: 'æ¢æ™¨', date: '0302', distance: 2, unit: 'km' },
            { id: 120, name: 'é™ˆå¾·ç´', date: '0303', distance: 3.17, unit: 'km' },
            { id: 121, name: 'æ–¹æ–‡', date: '0304', distance: 5, unit: 'km' },
            { id: 122, name: 'chuchu', date: '0304', distance: 5, unit: 'km' },
            { id: 123, name: 'å¾å²š', date: '0304', distance: 7.38, unit: 'km' },
            { id: 124, name: 'é™ˆå¾·ç´', date: '0305', distance: 4, unit: 'km' },
            { id: 125, name: 'é©¬æ–‡é›…', date: '0306', distance: 2, unit: 'km' },
            { id: 126, name: 'å¾å²š', date: '0306', distance: 12.1, unit: 'km' },
            { id: 127, name: 'æ–¹æ–‡', date: '0306', distance: 1.4, unit: 'km' },
            { id: 128, name: 'å¾å²š', date: '0307', distance: 8.24, unit: 'km' },
            { id: 129, name: 'é©¬æ–‡é›…', date: '0307', distance: 3.18, unit: 'km' },
            { id: 130, name: 'å¼ åª›åª›', date: '0307', distance: 5.10, unit: 'km' },
            { id: 131, name: 'é™ˆå¾·ç´', date: '0307', distance: 5, unit: 'km' },
            { id: 132, name: 'æ–¹æ–‡', date: '0307', distance: 10, unit: 'km' },
            { id: 133, name: 'é™ˆå³¥åµ˜', date: '0307', distance: 3, unit: 'km', note: 'w10' },
            { id: 134, name: 'é™ˆå¾·ç´', date: '0309', distance: 5.18, unit: 'km' },
            { id: 135, name: 'æ¢æ™¨', date: '0309', distance: 3, unit: 'km' },
            { id: 136, name: 'å¾å²š', date: '0309', distance: 12.3, unit: 'km' },
            { id: 137, name: 'æ¨é–', date: '0309', distance: 6, unit: 'km' },
            { id: 138, name: 'chuchu', date: '0310', distance: 3.5, unit: 'km' },
            { id: 139, name: 'é™ˆå³¥åµ˜', date: '0310', distance: 3, unit: 'km', note: 'w11' },
            { id: 140, name: 'æ–¹æ–‡', date: '0311', distance: 5, unit: 'km' },
            { id: 141, name: 'å¾å²š', date: '0312', distance: 8.77, unit: 'km' },
            { id: 142, name: 'é™ˆå¾·ç´', date: '0312', distance: 3.16, unit: 'km' },
            { id: 143, name: 'é©¬æ–‡é›…', date: '0312', distance: 2, unit: 'km' },
            { id: 144, name: 'é™ˆå¾·ç´', date: '0313', distance: 2.32, unit: 'km' },
            { id: 145, name: 'å¾å²š', date: '0313', distance: 11.24, unit: 'km' },
            { id: 146, name: 'å¾å²š', date: '0314', distance: 8, unit: 'km' },
            { id: 147, name: 'é™ˆå¾·ç´', date: '0314', distance: 2.31, unit: 'km' },
            { id: 148, name: 'æ–¹æ–‡', date: '0315', distance: 12, unit: 'km' },
            { id: 149, name: 'å¾å²š', date: '0316', distance: 16.2, unit: 'km' },
            { id: 150, name: 'æ¨é–', date: '0316', distance: 6, unit: 'km' },
            { id: 151, name: 'æ¢æ™¨', date: '0316', distance: 3, unit: 'km' },
            { id: 152, name: 'å¼ åª›åª›', date: '0316', distance: 5.54, unit: 'km' },
            { id: 153, name: 'é™ˆå³¥åµ˜', date: '0317', distance: 3, unit: 'km', note: 'w12' },
            { id: 154, name: 'é©¬æ–‡é›…', date: '0316', distance: 7.4, unit: 'km' },
            { id: 155, name: 'å¾å²š', date: '0318', distance: 8, unit: 'km' },
            { id: 156, name: 'æ–¹æ–‡', date: '0318', distance: 5, unit: 'km' },
            { id: 157, name: 'é©¬æ–‡é›…', date: '0320', distance: 2, unit: 'km' },
            { id: 158, name: 'å¾å²š', date: '0320', distance: 11.4, unit: 'km' },
            { id: 159, name: 'é™ˆå¾·ç´', date: '0320', distance: 3.28, unit: 'km' },
            { id: 160, name: 'å¼ åª›åª›', date: '0321', distance: 3.31, unit: 'km' },
            { id: 161, name: 'å¾å²š', date: '0321', distance: 7.9, unit: 'km' },
            { id: 162, name: 'é©¬æ–‡é›…', date: '0321', distance: 2, unit: 'km' },
            { id: 163, name: 'æ–¹æ–‡', date: '0322', distance: 10, unit: 'km' },
            { id: 164, name: 'å¾å²š', date: '0323', distance: 14, unit: 'km' },
            { id: 165, name: 'æ¢æ™¨', date: '0323', distance: 3.6, unit: 'km' },
            { id: 166, name: 'é©¬æ–‡é›…', date: '0323', distance: 6.11, unit: 'km' },
            { id: 167, name: 'é™ˆå¾·ç´', date: '0324', distance: 4.31, unit: 'km' },
            { id: 168, name: 'é™ˆå³¥åµ˜', date: '0324', distance: 3, unit: 'km', note: 'w13' },
            { id: 169, name: 'é™ˆå¾·ç´', date: '0325', distance: 3.2, unit: 'km' },
            { id: 170, name: 'æ–¹æ–‡', date: '0325', distance: 5, unit: 'km' },
            { id: 171, name: 'å¾å²š', date: '0325', distance: 8, unit: 'km' },
            { id: 172, name: 'é™ˆå³¥åµ˜', date: '0325', distance: 3, unit: 'km', note: 'w13' },
            { id: 173, name: 'chuchu', date: '0326', distance: 3.48, unit: 'km' },
            { id: 174, name: 'å¾å²š', date: '0327', distance: 10.8, unit: 'km' },
            { id: 175, name: 'æ–¹æ–‡', date: '0327', distance: 2, unit: 'km' },
            { id: 176, name: 'å¾å²š', date: '0328', distance: 8.3, unit: 'km' },
            { id: 177, name: 'chuchu', date: '0328', distance: 4.24, unit: 'km' },
            { id: 178, name: 'é™ˆå¾·ç´', date: '0328', distance: 3.46, unit: 'km' },
            { id: 179, name: 'æ–¹æ–‡', date: '0329', distance: 15, unit: 'km' },
            { id: 180, name: 'é©¬æ–‡é›…', date: '0329', distance: 5.45, unit: 'km' },
            { id: 181, name: 'å¼ åª›åª›', date: '0329', distance: 6.28, unit: 'km' },
            { id: 182, name: 'é™ˆå¾·ç´', date: '0329', distance: 2.74, unit: 'km' },
            { id: 183, name: 'å²å­Ÿä¸½', date: '0329', distance: 3.57, unit: 'km' },
            { id: 184, name: 'å¾å²š', date: '0330', distance: 9, unit: 'km' },
            { id: 185, name: 'æ¨é–', date: '0330', distance: 6.27, unit: 'km' },
            { id: 186, name: 'æ¢æ™¨', date: '0330', distance: 3, unit: 'km' },
            // 4æœˆæ•°æ®
            { id: 187, name: 'å¾å²š', date: '0401', distance: 11.21, unit: 'km' },
            { id: 188, name: 'æ–¹æ–‡', date: '0401', distance: 5, unit: 'km' },
            { id: 189, name: 'é™ˆå³¥åµ˜', date: '0401', distance: 3, unit: 'km' },
            { id: 190, name: 'chuchu', date: '0402', distance: 5.34, unit: 'km' },
            { id: 191, name: 'å²å­Ÿä¸½', date: '0401', distance: 3.16, unit: 'km' },
            { id: 192, name: 'é™ˆå¾·ç´', date: '0402', distance: 3, unit: 'km' },
            { id: 193, name: 'å²å­Ÿä¸½', date: '0401', distance: 3.1, unit: 'km' },
            { id: 194, name: 'chuchu', date: '0403', distance: 4.19, unit: 'km' },
            { id: 195, name: 'æ¨é–', date: '0403', distance: 7.5, unit: 'km' },
            { id: 196, name: 'é©¬æ–‡é›…', date: '0404', distance: 6.4, unit: 'km' },
            { id: 197, name: 'é™ˆå¾·ç´', date: '0404', distance: 8.93, unit: 'km' },
            { id: 198, name: 'å¾å²š', date: '0404', distance: 6, unit: 'km' },
            { id: 199, name: 'chuchu', date: '0405', distance: 3.25, unit: 'km' },
            { id: 200, name: 'æ¢æ™¨', date: '0406', distance: 3, unit: 'km' },
            { id: 201, name: 'é™ˆå¾·ç´', date: '0406', distance: 8, unit: 'km' },
            { id: 202, name: 'å¾å²š', date: '0406', distance: 12, unit: 'km' },
            { id: 203, name: 'æ¨é–', date: '0406', distance: 5, unit: 'km' },
            { id: 204, name: 'æ–¹æ–‡', date: '0406', distance: 5, unit: 'km' },
            { id: 205, name: 'å¼ åª›åª›', date: '0406', distance: 3.53, unit: 'km' },
            { id: 206, name: 'å²å­Ÿä¸½', date: '0406', distance: 3.14, unit: 'km' },
            { id: 207, name: 'chuchu', date: '0407', distance: 4.19, unit: 'km' },
            { id: 208, name: 'å¾å²š', date: '0408', distance: 11.54, unit: 'km' },
            { id: 209, name: 'å¾å²š', date: '0403', distance: 7.13, unit: 'km' },
            { id: 210, name: 'chuchu', date: '0409', distance: 6, unit: 'km' },
            { id: 211, name: 'é™ˆå¾·ç´', date: '0410', distance: 3.12, unit: 'km' },
            { id: 212, name: 'å¾å²š', date: '0410', distance: 12.59, unit: 'km' },
            { id: 213, name: 'æ–¹æ–‡', date: '0410', distance: 10, unit: 'km' },
            { id: 214, name: 'å¾å²š', date: '0411', distance: 6.4, unit: 'km' },
            { id: 215, name: 'chuchu', date: '0411', distance: 6, unit: 'km' },
            { id: 216, name: 'é©¬æ–‡é›…', date: '0411', distance: 3, unit: 'km' },
            { id: 217, name: 'é©¬æ–‡é›…', date: '0412', distance: 3, unit: 'km' },
            { id: 218, name: 'é™ˆå³¥åµ˜', date: '0413', distance: 3, unit: 'km', note: 'w15' },
            { id: 219, name: 'å¾å²š', date: '0413', distance: 14.7, unit: 'km' },
            { id: 220, name: 'æ¨é–', date: '0413', distance: 6, unit: 'km' },
            { id: 221, name: 'å²å­Ÿä¸½', date: '0413', distance: 3.14, unit: 'km' },
            { id: 222, name: 'å¼ åª›åª›', date: '0413', distance: 3.28, unit: 'km' },
            { id: 223, name: 'chuchu', date: '0415', distance: 4.67, unit: 'km' },
            { id: 224, name: 'å¾å²š', date: '0415', distance: 10.5, unit: 'km' },
            { id: 225, name: 'å²å­Ÿä¸½', date: '0416', distance: 2.2, unit: 'km' },
            { id: 226, name: 'æ–¹æ–‡', date: '0416', distance: 5, unit: 'km' },
            { id: 227, name: 'å¾å²š', date: '0417', distance: 7, unit: 'km' },
            { id: 228, name: 'é™ˆå¾·ç´', date: '0417', distance: 4, unit: 'km' },
            { id: 229, name: 'æ¨é–', date: '0418', distance: 7, unit: 'km' },
            { id: 230, name: 'chuchu', date: '0418', distance: 4.7, unit: 'km' },
            { id: 231, name: 'å¾å²š', date: '0418', distance: 8, unit: 'km' },
            { id: 232, name: 'é™ˆå³¥åµ˜', date: '0419', distance: 3, unit: 'km', note: 'w16' },
            { id: 233, name: 'æ–¹æ–‡', date: '0419', distance: 11, unit: 'km' },
            { id: 234, name: 'å²å­Ÿä¸½', date: '0420', distance: 3.09, unit: 'km' },
            { id: 235, name: 'å¼ åª›åª›', date: '0420', distance: 3.62, unit: 'km' },
            { id: 236, name: 'å¾å²š', date: '0420', distance: 26, unit: 'km' },
            { id: 237, name: 'æ¢æ™¨', date: '0420', distance: 3, unit: 'km' },
            { id: 238, name: 'chuchu', date: '0421', distance: 5.39, unit: 'km' },
            { id: 239, name: 'å¾å²š', date: '0422', distance: 6.7, unit: 'km' },
            { id: 240, name: 'chuchu', date: '0423', distance: 7.05, unit: 'km' },
            { id: 241, name: 'é™ˆå¾·ç´', date: '0423', distance: 3.27, unit: 'km' },
            { id: 242, name: 'å²å­Ÿä¸½', date: '0424', distance: 3.03, unit: 'km' },
            { id: 243, name: 'å¾å²š', date: '0424', distance: 11.38, unit: 'km' },
            { id: 244, name: 'é™ˆå³¥åµ˜', date: '0424', distance: 4, unit: 'km', note: 'w17' },
            { id: 245, name: 'chuchu', date: '0425', distance: 5.3, unit: 'km' },
            { id: 246, name: 'å¾å²š', date: '0425', distance: 10.73, unit: 'km' },
            { id: 247, name: 'å¼ åª›åª›', date: '0426', distance: 3.62, unit: 'km' },
            { id: 248, name: 'æ–¹æ–‡', date: '0426', distance: 15, unit: 'km' },
            { id: 249, name: 'æ¨é–', date: '0426', distance: 6, unit: 'km' },
            { id: 250, name: 'å²å­Ÿä¸½', date: '0426', distance: 4, unit: 'km' },
            { id: 251, name: 'æ¢æ™¨', date: '0426', distance: 3.7, unit: 'km' },
            { id: 252, name: 'å¾å²š', date: '0427', distance: 8.9, unit: 'km' },
            { id: 253, name: 'é©¬æ–‡é›…', date: '0427', distance: 3.67, unit: 'km' },
            { id: 254, name: 'å¾å²š', date: '0429', distance: 6.38, unit: 'km' },
            { id: 255, name: 'é™ˆå³¥åµ˜', date: '0429', distance: 3, unit: 'km', note: 'w18' },
            { id: 256, name: 'æ–¹æ–‡', date: '0429', distance: 5, unit: 'km' },
            // 5æœˆæ•°æ®
            { id: 257, name: 'å¾å²š', date: '0501', distance: 10.83, unit: 'km' },
            { id: 258, name: 'å¾å²š', date: '0502', distance: 6.39, unit: 'km' },
            { id: 259, name: 'å²å­Ÿä¸½', date: '0501', distance: 3, unit: 'km' },
            { id: 260, name: 'æ¢æ™¨', date: '0502', distance: 3, unit: 'km' },
            { id: 261, name: 'å²å­Ÿä¸½', date: '0502', distance: 2, unit: 'km' },
            { id: 262, name: 'å¼ åª›åª›', date: '0504', distance: 4.08, unit: 'km' },
            { id: 263, name: 'å¾å²š', date: '0504', distance: 11.4, unit: 'km' },
            { id: 264, name: 'æ¨é–', date: '0504', distance: 6, unit: 'km' },
            { id: 265, name: 'é©¬æ–‡é›…', date: '0504', distance: 3.6, unit: 'km' },
            { id: 266, name: 'é™ˆå¾·ç´', date: '0505', distance: 3.12, unit: 'km' },
            { id: 267, name: 'chuchu', date: '0507', distance: 4.75, unit: 'km' },
            { id: 268, name: 'é™ˆå³¥åµ˜', date: '0507', distance: 3, unit: 'km', note: 'w19' },
            { id: 269, name: 'æ–¹æ–‡', date: '0507', distance: 5, unit: 'km' },
            { id: 270, name: 'å¾å²š', date: '0508', distance: 7.26, unit: 'km' },
            { id: 271, name: 'å¾å²š', date: '0509', distance: 3, unit: 'km' },
            { id: 272, name: 'chuchu', date: '0510', distance: 5, unit: 'km' },
            { id: 273, name: 'æ–¹æ–‡', date: '0510', distance: 6, unit: 'km' },
            { id: 274, name: 'æ¨é–', date: '0510', distance: 10, unit: 'km' },
            { id: 275, name: 'é™ˆå¾·ç´', date: '0511', distance: 5.2, unit: 'km' },
            { id: 276, name: 'å¼ åª›åª›', date: '0511', distance: 6.57, unit: 'km' },
            { id: 277, name: 'å²å­Ÿä¸½', date: '0511', distance: 3, unit: 'km' },
            { id: 278, name: 'é©¬æ–‡é›…', date: '0511', distance: 3, unit: 'km' },
            { id: 279, name: 'æ¢æ™¨', date: '0511', distance: 3, unit: 'km' },
            { id: 280, name: 'chuchu', date: '0512', distance: 4.89, unit: 'km' },
            { id: 281, name: 'é™ˆå¾·ç´', date: '0513', distance: 4.26, unit: 'km' },
            { id: 282, name: 'å¾å²š', date: '0511', distance: 42.55, unit: 'km' },
            { id: 283, name: 'å¾å²š', date: '0513', distance: 3, unit: 'km' },
            { id: 284, name: 'æ–¹æ–‡', date: '0513', distance: 5, unit: 'km' },
            { id: 285, name: 'å¾å²š', date: '0515', distance: 5.78, unit: 'km' },
            { id: 286, name: 'chuchu', date: '0516', distance: 3.20, unit: 'km' },
            { id: 287, name: 'å¼ åª›åª›', date: '0517', distance: 4.27, unit: 'km' },
            { id: 288, name: 'é™ˆå³¥åµ˜', date: '0517', distance: 3, unit: 'km', note: 'w20' },
            { id: 289, name: 'é™ˆå¾·ç´', date: '0518', distance: 10.16, unit: 'km' },
            { id: 290, name: 'å²å­Ÿä¸½', date: '0518', distance: 6, unit: 'km' },
            { id: 291, name: 'æ¨é–', date: '0518', distance: 6, unit: 'km' },
            { id: 292, name: 'æ–¹æ–‡', date: '0518', distance: 10, unit: 'km' },
            { id: 293, name: 'é©¬æ–‡é›…', date: '0518', distance: 3.36, unit: 'km' },
            { id: 294, name: 'æ¢æ™¨', date: '0518', distance: 3, unit: 'km' },
            { id: 295, name: 'å¾å²š', date: '0518', distance: 8.1, unit: 'km' },
            { id: 296, name: 'é™ˆå³¥åµ˜', date: '0522', distance: 3, unit: 'km', note: 'w21' },
            { id: 297, name: 'å¾å²š', date: '0522', distance: 3, unit: 'km' },
            { id: 298, name: 'å¼ åª›åª›', date: '0523', distance: 3, unit: 'km' },
            { id: 299, name: 'é™ˆå¾·ç´', date: '0523', distance: 12, unit: 'km' },
            { id: 300, name: 'æ–¹æ–‡', date: '0521', distance: 5, unit: 'km' },
            { id: 301, name: 'é™ˆå¾·ç´', date: '0525', distance: 3.12, unit: 'km' },
            { id: 302, name: 'chuchu', date: '0526', distance: 3.18, unit: 'km' },
            { id: 303, name: 'æ–¹æ–‡', date: '0528', distance: 5, unit: 'km' },
            { id: 304, name: 'é™ˆå³¥åµ˜', date: '0529', distance: 3, unit: 'km', note: 'w22' },
            { id: 305, name: 'é™ˆå¾·ç´', date: '0529', distance: 4.24, unit: 'km' },
            { id: 306, name: 'å¾å²š', date: '0530', distance: 3, unit: 'km' },
            { id: 307, name: 'chuchu', date: '0530', distance: 4.82, unit: 'km' },
            { id: 308, name: 'æ–¹æ–‡', date: '0531', distance: 13, unit: 'km' },
            { id: 309, name: 'æ¨é–', date: '0531', distance: 6, unit: 'km' },
            { id: 310, name: 'å®‰è¿ª', date: '0531', distance: 3, unit: 'km' },
            { id: 311, name: 'å¾å²š', date: '0524', distance: 5, unit: 'km' },
            // 6æœˆæ•°æ®
            { id: 312, name: 'å¼ åª›åª›', date: '0601', distance: 3.21, unit: 'km' },
            { id: 313, name: 'å¾å²š', date: '0601', distance: 8.33, unit: 'km' },
            { id: 314, name: 'é™ˆå¾·ç´', date: '0602', distance: 7.58, unit: 'km' },
            { id: 315, name: 'å¾å²š', date: '0603', distance: 6.27, unit: 'km' },
            { id: 316, name: 'æ–¹æ–‡', date: '0603', distance: 5, unit: 'km' },
            { id: 317, name: 'chuchu', date: '0604', distance: 4.14, unit: 'km' },
            { id: 318, name: 'å¾å²š', date: '0605', distance: 5.58, unit: 'km' },
            { id: 319, name: 'chuchu', date: '0606', distance: 5, unit: 'km' },
            { id: 320, name: 'é™ˆå¾·ç´', date: '0606', distance: 4.27, unit: 'km' },
            { id: 321, name: 'å¾å²š', date: '0606', distance: 6.5, unit: 'km' },
            { id: 322, name: 'å®‰è¿ª', date: '0607', distance: 3.12, unit: 'km' },
            { id: 323, name: 'å²å­Ÿä¸½', date: '0601', distance: 4.3, unit: 'km' },
            { id: 324, name: 'å²å­Ÿä¸½', date: '0607', distance: 5.4, unit: 'km' },
            { id: 325, name: 'å¾å²š', date: '0608', distance: 12.68, unit: 'km' },
            { id: 326, name: 'é™ˆå³¥åµ˜', date: '0608', distance: 3, unit: 'km', note: 'w23' },
            { id: 327, name: 'æ¨é–', date: '0608', distance: 6, unit: 'km' },
            { id: 328, name: 'æ¢æ™¨', date: '0608', distance: 4, unit: 'km' },
            { id: 329, name: 'é©¬æ–‡é›…', date: '0608', distance: 5.5, unit: 'km' },
            { id: 330, name: 'æ–¹æ–‡', date: '0609', distance: 5, unit: 'km' },
            { id: 331, name: 'é™ˆå¾·ç´', date: '0610', distance: 5.25, unit: 'km' },
            { id: 332, name: 'å¾å²š', date: '0610', distance: 6.66, unit: 'km' },
            { id: 333, name: 'å¼ åª›åª›', date: '0612', distance: 3.22, unit: 'km' },
            { id: 334, name: 'å¾å²š', date: '0612', distance: 7.27, unit: 'km' },
            { id: 335, name: 'å¾å²š', date: '0613', distance: 7.35, unit: 'km' },
            { id: 336, name: 'å²å­Ÿä¸½', date: '0614', distance: 3.12, unit: 'km' },
            { id: 337, name: 'å¼ åª›åª›', date: '0614', distance: 7.2, unit: 'km' },
            { id: 338, name: 'å®‰è¿ª', date: '0615', distance: 3.2, unit: 'km' },
            { id: 339, name: 'é©¬æ–‡é›…', date: '0615', distance: 4.1, unit: 'km' },
            { id: 340, name: 'æ¢æ™¨', date: '0615', distance: 4, unit: 'km' },
            { id: 341, name: 'æ¨é–', date: '0615', distance: 6.4, unit: 'km' },
            { id: 342, name: 'é™ˆå³¥åµ˜', date: '0615', distance: 3, unit: 'km', note: 'w24' },
            { id: 343, name: 'å¾å²š', date: '0616', distance: 6.35, unit: 'km' },
            { id: 344, name: 'å¾å²š', date: '0617', distance: 6.4, unit: 'km' },
            { id: 345, name: 'å²å­Ÿä¸½', date: '0618', distance: 3.27, unit: 'km' },
            { id: 346, name: 'å¾å²š', date: '0619', distance: 8.1, unit: 'km' },
            { id: 347, name: 'é™ˆå¾·ç´', date: '0619', distance: 5.33, unit: 'km' },
            { id: 348, name: 'å¾å²š', date: '0620', distance: 6.14, unit: 'km' },
            { id: 349, name: 'å¾å²š', date: '0622', distance: 12.13, unit: 'km' },
            { id: 350, name: 'å¼ åª›åª›', date: '0622', distance: 5.23, unit: 'km' },
            { id: 351, name: 'é™ˆå³¥åµ˜', date: '0622', distance: 2, unit: 'km', note: 'w25' },
            { id: 352, name: 'æ¨é–', date: '0622', distance: 6, unit: 'km' },
            { id: 353, name: 'æ–¹æ–‡', date: '0622', distance: 5, unit: 'km' },
            { id: 354, name: 'å®‰è¿ª', date: '0622', distance: 3, unit: 'km', note: '+èˆè¹ˆ2h' },
            { id: 355, name: 'æ¢æ™¨', date: '0622', distance: 4.3, unit: 'km' },
            { id: 356, name: 'é©¬æ–‡é›…', date: '0622', distance: 4.47, unit: 'km' },
            { id: 357, name: 'é™ˆå¾·ç´', date: '0623', distance: 5.14, unit: 'km' },
            { id: 358, name: 'chuchu', date: '0624', distance: 4.3, unit: 'km' },
            { id: 359, name: 'å¾å²š', date: '0624', distance: 8, unit: 'km' },
            { id: 360, name: 'æ–¹æ–‡', date: '0624', distance: 5, unit: 'km' },
            { id: 361, name: 'å²å­Ÿä¸½', date: '0624', distance: 3, unit: 'km' },
            { id: 362, name: 'é™ˆå¾·ç´', date: '0626', distance: 3.4, unit: 'km' },
            { id: 363, name: 'chuchu', date: '0626', distance: 5.09, unit: 'km' },
            { id: 364, name: 'å¾å²š', date: '0626', distance: 8.17, unit: 'km' },
            { id: 365, name: 'å¾å²š', date: '0627', distance: 8.09, unit: 'km' },
            { id: 366, name: 'æ–¹æ–‡', date: '0627', distance: 10, unit: 'km' },
            { id: 367, name: 'å¼ åª›åª›', date: '0628', distance: 8, unit: 'km' },
            { id: 368, name: 'é™ˆå¾·ç´', date: '0628', distance: 10.41, unit: 'km' },
            { id: 369, name: 'æ¢æ™¨', date: '0628', distance: 2, unit: 'km' },
            { id: 370, name: 'å¾å²š', date: '0629', distance: 11.07, unit: 'km' },
            { id: 371, name: 'é™ˆå³¥åµ˜', date: '0629', distance: 4, unit: 'km', note: 'w26' },
            { id: 372, name: 'å®‰è¿ª', date: '0628', distance: 0, unit: 'km', note: 'èˆè¹ˆ2h' },
            { id: 373, name: 'å®‰è¿ª', date: '0629', distance: 0, unit: 'km', note: 'èˆè¹ˆ2h' },
            { id: 374, name: 'ææ–‡æ¶›', date: '0629', distance: 7.25, unit: 'km' },
            { id: 375, name: 'æ¢æ™¨', date: '0629', distance: 4, unit: 'km' },
            { id: 376, name: 'é©¬æ–‡é›…', date: '0629', distance: 4, unit: 'km' },
            { id: 377, name: 'chuchu', date: '0630', distance: 4, unit: 'km' },
            // 7æœˆæ•°æ®
            { id: 378, name: 'å¾å²š', date: '0701', distance: 5.56, unit: 'km' },
            { id: 379, name: 'ææ–‡æ¶›', date: '0702', distance: 6, unit: 'km' },
            { id: 380, name: 'é™ˆå¾·ç´', date: '0703', distance: 2, unit: 'km' },
            { id: 381, name: 'å¾å²š', date: '0703', distance: 6.5, unit: 'km' },
            { id: 382, name: 'æ–¹æ–‡', date: '0705', distance: 5, unit: 'km' },
            { id: 383, name: 'é™ˆå³¥åµ˜', date: '0705', distance: 2.4, unit: 'km', note: 'w27' },
            { id: 384, name: 'é™ˆå¾·ç´', date: '0706', distance: 6.14, unit: 'km' },
            { id: 385, name: 'å¾å²š', date: '0706', distance: 12.5, unit: 'km' },
            { id: 386, name: 'å®‰è¿ª', date: '0705', distance: 0, unit: 'km', note: 'èˆè¹ˆ2h' },
            { id: 387, name: 'å®‰è¿ª', date: '0706', distance: 4, unit: 'km' },
            { id: 388, name: 'å¼ åª›åª›', date: '0706', distance: 4.15, unit: 'km' },
            { id: 389, name: 'æ¨é–', date: '0706', distance: 6, unit: 'km' },
            { id: 390, name: 'æ¢æ™¨', date: '0705', distance: 2, unit: 'km' },
            { id: 391, name: 'æ¢æ™¨', date: '0706', distance: 3, unit: 'km' },
            { id: 392, name: 'é©¬æ–‡é›…', date: '0706', distance: 4, unit: 'km' },
            { id: 393, name: 'å¾å²š', date: '0707', distance: 6, unit: 'km' },
            { id: 394, name: 'é™ˆå³¥åµ˜', date: '0709', distance: 4, unit: 'km', note: 'w28' },
            { id: 395, name: 'å¾å²š', date: '0712', distance: 5.2, unit: 'km' },
            { id: 396, name: 'æ–¹æ–‡', date: '0712', distance: 10, unit: 'km' },
            { id: 397, name: 'å²å­Ÿä¸½', date: '0712', distance: 4, unit: 'km' },
            { id: 398, name: 'é™ˆå¾·ç´', date: '0712', distance: 6, unit: 'km' },
            { id: 399, name: 'ææ–‡æ¶›', date: '0712', distance: 4, unit: 'km' },
            { id: 400, name: 'å¾å²š', date: '0713', distance: 11, unit: 'km' },
            { id: 401, name: 'å¼ åª›åª›', date: '0713', distance: 4.05, unit: 'km' },
            { id: 402, name: 'æ¢æ™¨', date: '0713', distance: 4.2, unit: 'km' },
            { id: 403, name: 'å²å­Ÿä¸½', date: '0714', distance: 4, unit: 'km' },
            { id: 404, name: 'chuchu', date: '0716', distance: 4.30, unit: 'km' },
            { id: 405, name: 'å¾å²š', date: '0716', distance: 5, unit: 'km' },
            { id: 406, name: 'å¾å²š', date: '0718', distance: 5.09, unit: 'km' },
            { id: 407, name: 'å¼ åª›åª›', date: '0718', distance: 4.29, unit: 'km' },
            { id: 408, name: 'é™ˆå¾·ç´', date: '0720', distance: 4.1, unit: 'km' },
            { id: 409, name: 'å®‰è¿ª', date: '0720', distance: 4.1, unit: 'km' },
            { id: 410, name: 'å®‰è¿ª', date: '0719', distance: 0, unit: 'km', note: 'è·³èˆ2h' },
            { id: 411, name: 'æ¢æ™¨', date: '0719', distance: 2.5, unit: 'km' },
            { id: 412, name: 'å¾å²š', date: '0720', distance: 10, unit: 'km' },
            { id: 413, name: 'é™ˆå¾·ç´', date: '0722', distance: 5.29, unit: 'km' },
            { id: 414, name: 'å¾å²š', date: '0722', distance: 5.36, unit: 'km' },
            { id: 415, name: 'ææ–‡æ¶›', date: '0722', distance: 5.72, unit: 'km' },
            { id: 416, name: 'æ–¹æ–‡', date: '0723', distance: 5, unit: 'km' },
            { id: 417, name: 'å¾å²š', date: '0724', distance: 5.4, unit: 'km' },
            { id: 418, name: 'é™ˆå¾·ç´', date: '0726', distance: 5.4, unit: 'km' },
            { id: 419, name: 'æ¢æ™¨', date: '0726', distance: 4.2, unit: 'km' },
            { id: 420, name: 'é™ˆå¾·ç´', date: '0727', distance: 6.26, unit: 'km' },
            { id: 421, name: 'å¾å²š', date: '0727', distance: 10, unit: 'km' },
            { id: 422, name: 'é™ˆå³¥åµ˜', date: '0727', distance: 4, unit: 'km', note: 'w30' },
            { id: 423, name: 'å®‰è¿ª', date: '0727', distance: 4.04, unit: 'km' },
            { id: 424, name: 'æ¨é–', date: '0727', distance: 6, unit: 'km' },
            { id: 425, name: 'å¾å²š', date: '0730', distance: 6, unit: 'km' },
            { id: 426, name: 'å¾å²š', date: '0731', distance: 5, unit: 'km' },
            { id: 427, name: 'å¾å²š', date: '0704', distance: 5, unit: 'km' },
            { id: 428, name: 'æ–¹æ–‡', date: '0729', distance: 5, unit: 'km' },
            { id: 429, name: 'å¼ åª›åª›', date: '0731', distance: 4.09, unit: 'km' },
            // 8æœˆæ•°æ®
            { id: 430, name: 'é™ˆå¾·ç´', date: '0803', distance: 4.21, unit: 'km' },
            { id: 431, name: 'å²å­Ÿä¸½', date: '0804', distance: 4, unit: 'km' },
            { id: 432, name: 'æ¢æ™¨', date: '0803', distance: 5, unit: 'km' },
            { id: 433, name: 'å¾å²š', date: '0801', distance: 5, unit: 'km' },
            { id: 434, name: 'å¾å²š', date: '0803', distance: 10.2, unit: 'km' },
            { id: 435, name: 'å¾å²š', date: '0805', distance: 5.1, unit: 'km' },
            { id: 436, name: 'å¾å²š', date: '0807', distance: 5, unit: 'km' },
            { id: 437, name: 'å¾å²š', date: '0808', distance: 5.38, unit: 'km' },
            { id: 438, name: 'å²å­Ÿä¸½', date: '0810', distance: 4, unit: 'km' },
            { id: 439, name: 'å¾å²š', date: '0810', distance: 10.38, unit: 'km' },
            { id: 440, name: 'æ–¹æ–‡', date: '0810', distance: 6, unit: 'km' },
            { id: 441, name: 'é™ˆå¾·ç´', date: '0810', distance: 5.25, unit: 'km' },
            { id: 442, name: 'ææ–‡æ¶›', date: '0810', distance: 4.63, unit: 'km' },
            { id: 443, name: 'æ¨é–', date: '0810', distance: 6, unit: 'km' },
            { id: 444, name: 'æ¢æ™¨', date: '0810', distance: 4, unit: 'km' },
            { id: 445, name: 'å¾å²š', date: '0812', distance: 6.4, unit: 'km' },
            { id: 446, name: 'å¾å²š', date: '0814', distance: 6, unit: 'km' },
            { id: 447, name: 'ææ–‡æ¶›', date: '0816', distance: 5.74, unit: 'km' },
            { id: 448, name: 'å¾å²š', date: '0815', distance: 5, unit: 'km' },
            { id: 449, name: 'å¾å²š', date: '0817', distance: 10.47, unit: 'km' },
            { id: 450, name: 'é™ˆå¾·ç´', date: '0817', distance: 4.27, unit: 'km' },
            { id: 451, name: 'æ–¹æ–‡', date: '0815', distance: 4, unit: 'km' },
            { id: 452, name: 'æ¢æ™¨', date: '0817', distance: 5, unit: 'km' },
            { id: 453, name: 'æ¨é–', date: '0817', distance: 6, unit: 'km' },
            { id: 454, name: 'å¾å²š', date: '0819', distance: 5, unit: 'km' },
            { id: 455, name: 'å¾å²š', date: '0822', distance: 2.5, unit: 'km' },
            { id: 456, name: 'å¾å²š', date: '0824', distance: 10.10, unit: 'km' },
            { id: 457, name: 'é™ˆå¾·ç´', date: '0824', distance: 5.21, unit: 'km' },
            { id: 458, name: 'å¾å²š', date: '0828', distance: 5, unit: 'km' },
            { id: 459, name: 'å¾å²š', date: '0829', distance: 5.1, unit: 'km' },
            { id: 460, name: 'æ¢æ™¨', date: '0831', distance: 4, unit: 'km' },
            { id: 461, name: 'å¾å²š', date: '0831', distance: 6.6, unit: 'km' },
            { id: 462, name: 'é™ˆå³¥åµ˜', date: '0831', distance: 4, unit: 'km', note: 'w35' },
            // 9æœˆæ•°æ®
            { id: 463, name: 'å¾å²š', date: '0903', distance: 5.03, unit: 'km' },
            { id: 464, name: 'å¾å²š', date: '0904', distance: 5.15, unit: 'km' },
            { id: 465, name: 'æ–¹æ–‡', date: '0906', distance: 10, unit: 'km' },
            { id: 466, name: 'æ¨é–', date: '0906', distance: 6, unit: 'km' },
            { id: 467, name: 'é™ˆå³¥åµ˜', date: '0906', distance: 4, unit: 'km', note: 'w36' },
            { id: 468, name: 'å¾å²š', date: '0906', distance: 5, unit: 'km' },
            { id: 469, name: 'å²å­Ÿä¸½', date: '0907', distance: 4, unit: 'km' },
            { id: 470, name: 'æ¢æ™¨', date: '0907', distance: 5, unit: 'km' },
            { id: 471, name: 'é™ˆå¾·ç´', date: '0907', distance: 4.29, unit: 'km' },
            { id: 472, name: 'å¼ åª›åª›', date: '0907', distance: 4.11, unit: 'km' },
            { id: 473, name: 'ææ–‡æ¶›', date: '0907', distance: 6, unit: 'km' },
            { id: 474, name: 'å¾å²š', date: '0909', distance: 5, unit: 'km' },
            { id: 475, name: 'å¾å²š', date: '0910', distance: 3.2, unit: 'km' },
            { id: 476, name: 'å¾å²š', date: '0912', distance: 5.2, unit: 'km' },
            { id: 477, name: 'æ–¹æ–‡', date: '0914', distance: 6, unit: 'km' },
            { id: 478, name: 'å¾å²š', date: '0914', distance: 10.3, unit: 'km' },
            { id: 479, name: 'ææ–‡æ¶›', date: '0914', distance: 4.48, unit: 'km' },
            { id: 480, name: 'å®‰è¿ª', date: '0913', distance: 2.57, unit: 'km', note: 'è·³èˆ2h+è·‘æ­¥' },
            { id: 481, name: 'å®‰è¿ª', date: '0914', distance: 0, unit: 'km', note: 'è·³èˆ2h' },
            { id: 482, name: 'é™ˆå³¥åµ˜', date: '0914', distance: 4, unit: 'km', note: 'w37' },
            { id: 483, name: 'æ¢æ™¨', date: '0914', distance: 5, unit: 'km' },
            { id: 484, name: 'æ¨é–', date: '0913', distance: 10, unit: 'km' },
            { id: 485, name: 'å¾å²š', date: '0918', distance: 6, unit: 'km' },
            { id: 486, name: 'å²å­Ÿä¸½', date: '0920', distance: 4, unit: 'km' },
            { id: 487, name: 'å¾å²š', date: '0920', distance: 5.19, unit: 'km' },
            { id: 488, name: 'ææ–‡æ¶›', date: '0921', distance: 5.2, unit: 'km' },
            { id: 489, name: 'ææ–‡æ¶›', date: '0925', distance: 5, unit: 'km' },
            { id: 490, name: 'å¼ åª›åª›', date: '0927', distance: 4.19, unit: 'km' },
            { id: 491, name: 'æ¢æ™¨', date: '0928', distance: 6, unit: 'km' },
            { id: 492, name: 'æ–¹æ–‡', date: '0928', distance: 5, unit: 'km' },
            { id: 493, name: 'é™ˆå³¥åµ˜', date: '0929', distance: 4, unit: 'km', note: 'w39' },
            // 10æœˆæ•°æ®
            { id: 494, name: 'é™ˆå¾·ç´', date: '1002', distance: 4.16, unit: 'km' },
            { id: 495, name: 'å¾å²š', date: '1003', distance: 6.28, unit: 'km' },
            { id: 496, name: 'å¾å²š', date: '1004', distance: 5.29, unit: 'km' },
            { id: 497, name: 'å¾å²š', date: '1005', distance: 6.03, unit: 'km' },
            { id: 498, name: 'å²å­Ÿä¸½', date: '1006', distance: 4, unit: 'km' },
            { id: 499, name: 'å¾å²š', date: '1007', distance: 5.21, unit: 'km' },
            { id: 500, name: 'å®‰è¿ª', date: '1004', distance: 0, unit: 'km', note: 'è·³èˆ2h' },
            { id: 501, name: 'å®‰è¿ª', date: '1005', distance: 0, unit: 'km', note: 'è·³èˆ2h' },
            { id: 502, name: 'å®‰è¿ª', date: '1006', distance: 2.1, unit: 'km' },
            { id: 503, name: 'å®‰è¿ª', date: '1007', distance: 2.15, unit: 'km', note: 'è·³èˆ2h+è·‘æ­¥' },
            { id: 504, name: 'å¾å²š', date: '1010', distance: 5.2, unit: 'km' },
            { id: 505, name: 'é™ˆå³¥åµ˜', date: '1011', distance: 4, unit: 'km', note: 'w41' },
            { id: 506, name: 'å¾å²š', date: '1012', distance: 10.3, unit: 'km' },
            { id: 507, name: 'æ¨é–', date: '1012', distance: 6, unit: 'km' },
            { id: 508, name: 'æ¢æ™¨', date: '1012', distance: 5, unit: 'km' },
            { id: 509, name: 'ææ–‡æ¶›', date: '1012', distance: 10, unit: 'km' },
            { id: 510, name: 'å¾å²š', date: '1014', distance: 5, unit: 'km' },
            { id: 511, name: 'ææ–‡æ¶›', date: '1014', distance: 5.4, unit: 'km' },
            { id: 512, name: 'é™ˆå³¥åµ˜', date: '1015', distance: 3, unit: 'km', note: 'w42' },
            { id: 513, name: 'å¾å²š', date: '1016', distance: 5, unit: 'km' },
            { id: 514, name: 'ææ–‡æ¶›', date: '1015', distance: 2.7, unit: 'km' },
            { id: 515, name: 'ææ–‡æ¶›', date: '1017', distance: 5, unit: 'km' },
            { id: 516, name: 'å¾å²š', date: '1017', distance: 3.5, unit: 'km' },
            { id: 517, name: 'é™ˆå³¥åµ˜', date: '1019', distance: 3, unit: 'km', note: 'w42' },
            { id: 518, name: 'å²å­Ÿä¸½', date: '1019', distance: 4, unit: 'km' },
            { id: 519, name: 'å¾å²š', date: '1019', distance: 11, unit: 'km' },
            { id: 520, name: 'æ¨é–', date: '1019', distance: 6, unit: 'km' },
            { id: 521, name: 'æ¢æ™¨', date: '1019', distance: 5, unit: 'km' },
            { id: 522, name: 'å¾å²š', date: '1021', distance: 5.18, unit: 'km' },
            { id: 523, name: 'ææ–‡æ¶›', date: '1021', distance: 4, unit: 'km' },
            { id: 524, name: 'å¾å²š', date: '1023', distance: 5.2, unit: 'km' },
            { id: 525, name: 'å¼ åª›åª›', date: '1024', distance: 3.3, unit: 'km' },
            { id: 526, name: 'ææ–‡æ¶›', date: '1022', distance: 3.59, unit: 'km' },
            { id: 527, name: 'æ–¹æ–‡', date: '1025', distance: 10, unit: 'km' },
            { id: 528, name: 'å²å­Ÿä¸½', date: '1026', distance: 5, unit: 'km' },
            { id: 529, name: 'å¾å²š', date: '1025', distance: 6, unit: 'km' },
            { id: 530, name: 'å¾å²š', date: '1026', distance: 10, unit: 'km' },
            { id: 531, name: 'æ¢æ™¨', date: '1026', distance: 5, unit: 'km' },
            { id: 532, name: 'é™ˆå¾·ç´', date: '1028', distance: 4.17, unit: 'km' },
            { id: 533, name: 'ææ–‡æ¶›', date: '1029', distance: 4, unit: 'km' },
            { id: 534, name: 'å¾å²š', date: '1030', distance: 5, unit: 'km' },
            { id: 535, name: 'å¾å²š', date: '1031', distance: 5.6, unit: 'km' },
            // 11æœˆæ•°æ®
            { id: 536, name: 'æ–¹æ–‡', date: '1101', distance: 5, unit: 'km' },
            { id: 537, name: 'é™ˆå¾·ç´', date: '1102', distance: 5, unit: 'km' },
            { id: 538, name: 'å¾å²š', date: '1102', distance: 10.4, unit: 'km' },
            { id: 539, name: 'é™ˆå¾·ç´', date: '1104', distance: 4.2, unit: 'km' },
            { id: 540, name: 'å¾å²š', date: '1104', distance: 5.15, unit: 'km' },
            { id: 541, name: 'æ–¹æ–‡', date: '1108', distance: 12, unit: 'km' },
            { id: 542, name: 'æ¢æ™¨', date: '1102', distance: 5, unit: 'km' },
            { id: 543, name: 'æ¢æ™¨', date: '1109', distance: 5, unit: 'km' },
            { id: 544, name: 'å¾å²š', date: '1108', distance: 6, unit: 'km' },
            { id: 545, name: 'å¾å²š', date: '1111', distance: 6.25, unit: 'km' },
            { id: 546, name: 'å¾å²š', date: '1113', distance: 5, unit: 'km' },
            { id: 547, name: 'æ–¹æ–‡', date: '1114', distance: 8, unit: 'km' },
            { id: 548, name: 'å¾å²š', date: '1115', distance: 6.5, unit: 'km' },
            { id: 549, name: 'é™ˆå³¥åµ˜', date: '1108', distance: 3, unit: 'km', note: 'w45' },
            { id: 550, name: 'é™ˆå³¥åµ˜', date: '1115', distance: 3, unit: 'km', note: 'w46' },
            { id: 551, name: 'å¾å²š', date: '1116', distance: 11.17, unit: 'km' },
            { id: 552, name: 'å¾å²š', date: '1119', distance: 5.15, unit: 'km' },
            { id: 553, name: 'é™ˆå¾·ç´', date: '1119', distance: 4.36, unit: 'km' },
            { id: 554, name: 'å¾å²š', date: '1120', distance: 5, unit: 'km' },
            { id: 555, name: 'æ¢æ™¨', date: '1123', distance: 5.2, unit: 'km' },
            { id: 556, name: 'å¾å²š', date: '1123', distance: 10, unit: 'km' },
            { id: 557, name: 'chuchu', date: '1127', distance: 4.40, unit: 'km', note: 'åŸæ•°æ®å•ä½é”™è¯¯å·²ä¿®æ­£' },
            { id: 558, name: 'ææ–‡æ¶›', date: '1129', distance: 12, unit: 'km' },
            { id: 559, name: 'é™ˆå¾·ç´', date: '1130', distance: 5.22, unit: 'km' },
            { id: 560, name: 'ææ–‡æ¶›', date: '1130', distance: 8, unit: 'km' },
            // 12æœˆæ•°æ®
            { id: 561, name: 'æ–¹æ–‡', date: '1206', distance: 10, unit: 'km' },
            { id: 562, name: 'å¾å²š', date: '1203', distance: 3, unit: 'km' },
            { id: 563, name: 'å¾å²š', date: '1204', distance: 4.2, unit: 'km' },
            { id: 564, name: 'å¾å²š', date: '1206', distance: 5.67, unit: 'km' },
            { id: 565, name: 'å¾å²š', date: '1207', distance: 12.93, unit: 'km' },
            { id: 566, name: 'å¾å²š', date: '1211', distance: 3, unit: 'km' },
            { id: 567, name: 'å¾å²š', date: '1213', distance: 5.9, unit: 'km' },
            { id: 568, name: 'å¾å²š', date: '1216', distance: 5, unit: 'km' },
            { id: 569, name: 'é™ˆå³¥åµ˜', date: '1204', distance: 3, unit: 'km' },
            { id: 570, name: 'é™ˆå³¥åµ˜', date: '1215', distance: 3.6, unit: 'km' },
            { id: 571, name: 'å¾å²š', date: '1223', distance: 5, unit: 'km' },
            { id: 572, name: 'å¾å²š', date: '1225', distance: 5.12, unit: 'km' },
            { id: 573, name: 'é™ˆå³¥åµ˜', date: '1223', distance: 3, unit: 'km' },
            { id: 574, name: 'é™ˆå³¥åµ˜', date: '1227', distance: 4, unit: 'km' },
            { id: 575, name: 'å¾å²š', date: '1228', distance: 7.1, unit: 'km' },
            { id: 576, name: 'å¾å²š', date: '1231', distance: 5, unit: 'km' },
            { id: 577, name: 'é©¬æ–‡é›…', date: '1231', distance: 3, unit: 'km' }
        ];

        // å®é™…ä½¿ç”¨çš„æ•°æ®
        let rawData = [];

        // ============== åˆå§‹åŒ– ==============
        async function initApp() {
            showLoading('åˆå§‹åŒ–ä¸­...');

            // æ£€æŸ¥æœ¬åœ°å­˜å‚¨çš„é…ç½®
            const savedUrl = localStorage.getItem('supabase_url');
            const savedKey = localStorage.getItem('supabase_key');

            if (savedUrl && savedKey) {
                document.getElementById('supabaseUrl').value = savedUrl;
                document.getElementById('supabaseKey').value = savedKey;
                await connectToSupabase(savedUrl, savedKey);
            } else {
                // ä½¿ç”¨æœ¬åœ°æ•°æ®
                rawData = [...localData];
                updateConnectionStatus(false);
            }

            // æ¸²æŸ“é¡µé¢
            renderAll();
            hideLoading();
        }

        // è¿æ¥Supabase
        async function connectToSupabase(url, key) {
            try {
                showLoading('è¿æ¥æ•°æ®åº“...');
                supabaseClient = supabase.createClient(url, key);

                // æµ‹è¯•è¿æ¥å¹¶è·å–æ•°æ®
                const { data, error } = await supabaseClient
                    .from('running_records')
                    .select('*')
                    .order('id', { ascending: true });

                if (error) throw error;

                rawData = data || [];
                isConnected = true;
                updateConnectionStatus(true);
                console.log('Supabase è¿æ¥æˆåŠŸï¼ŒåŠ è½½äº†', rawData.length, 'æ¡è®°å½•');

            } catch (err) {
                console.error('Supabase è¿æ¥å¤±è´¥:', err);
                rawData = [...localData];
                isConnected = false;
                updateConnectionStatus(false);
            }
        }

        // æ›´æ–°è¿æ¥çŠ¶æ€æ˜¾ç¤º
        function updateConnectionStatus(connected) {
            const indicator = document.getElementById('statusIndicator');
            const text = document.getElementById('statusText');

            if (connected) {
                indicator.className = 'status-indicator status-connected';
                text.textContent = 'å·²è¿æ¥ Supabase';
            } else {
                indicator.className = 'status-indicator status-disconnected';
                text.textContent = 'æœ¬åœ°æ¨¡å¼';
            }
        }

        // æ˜¾ç¤º/éšè—åŠ è½½
        function showLoading(text = 'åŠ è½½ä¸­...') {
            document.getElementById('loadingText').textContent = text;
            document.getElementById('loadingOverlay').classList.remove('hidden');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.add('hidden');
        }

        // ============== é…ç½®ç®¡ç† ==============
        function openConfigModal() {
            document.getElementById('configModal').classList.add('active');
            document.getElementById('configSuccess').style.display = 'none';
            document.getElementById('configError').style.display = 'none';
        }

        function closeConfigModal() {
            document.getElementById('configModal').classList.remove('active');
        }

        async function saveConfig() {
            const url = document.getElementById('supabaseUrl').value.trim();
            const key = document.getElementById('supabaseKey').value.trim();

            if (!url || !key) {
                document.getElementById('configError').textContent = 'è¯·å¡«å†™å®Œæ•´çš„é…ç½®ä¿¡æ¯';
                document.getElementById('configError').style.display = 'block';
                return;
            }

            localStorage.setItem('supabase_url', url);
            localStorage.setItem('supabase_key', key);

            await connectToSupabase(url, key);

            if (isConnected) {
                document.getElementById('configSuccess').style.display = 'block';
                document.getElementById('configError').style.display = 'none';
                renderAll();
                setTimeout(closeConfigModal, 1500);
            } else {
                document.getElementById('configError').textContent = 'è¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥é…ç½®ä¿¡æ¯';
                document.getElementById('configError').style.display = 'block';
            }
        }

        function clearConfig() {
            localStorage.removeItem('supabase_url');
            localStorage.removeItem('supabase_key');
            supabaseClient = null;
            isConnected = false;
            rawData = [...localData];
            updateConnectionStatus(false);
            renderAll();
            closeConfigModal();
        }

        // ============== æ•°æ®æ“ä½œ ==============
        // æ·»åŠ å•æ¡æ•°æ®
        async function saveData() {
            const selectName = document.getElementById('inputName').value;
            const newName = document.getElementById('inputNewName').value.trim();
            const dateInput = document.getElementById('inputDate').value;
            const distance = parseFloat(document.getElementById('inputDistance').value);
            const note = document.getElementById('inputNote').value.trim();

            const name = newName || selectName;
            if (!name) {
                showAddError('è¯·é€‰æ‹©æˆ–è¾“å…¥å§“å');
                return;
            }
            if (!dateInput) {
                showAddError('è¯·é€‰æ‹©æ—¥æœŸ');
                return;
            }
            if (isNaN(distance) || distance < 0) {
                showAddError('è¯·è¾“å…¥æœ‰æ•ˆçš„è·ç¦»');
                return;
            }

            // è½¬æ¢æ—¥æœŸæ ¼å¼
            const dateParts = dateInput.split('-');
            const dateCode = dateParts[1] + dateParts[2];

            const newRecord = {
                name: name,
                date: dateCode,
                distance: distance,
                unit: 'km',
                note: note || null
            };

            if (isConnected && supabaseClient) {
                try {
                    const { data, error } = await supabaseClient
                        .from('running_records')
                        .insert([newRecord])
                        .select();

                    if (error) throw error;

                    rawData.push(data[0]);
                    showAddSuccess();
                    renderAll();

                } catch (err) {
                    showAddError('ä¿å­˜å¤±è´¥: ' + err.message);
                    return;
                }
            } else {
                // æœ¬åœ°æ¨¡å¼
                const maxId = rawData.length > 0 ? Math.max(...rawData.map(r => r.id)) : 0;
                newRecord.id = maxId + 1;
                rawData.push(newRecord);
                showAddSuccess();
                renderAll();
            }
        }

        function showAddSuccess() {
            document.getElementById('addSuccess').style.display = 'block';
            document.getElementById('addError').style.display = 'none';
            // æ¸…ç©ºè¡¨å•
            document.getElementById('inputNewName').value = '';
            document.getElementById('inputDistance').value = '';
            document.getElementById('inputNote').value = '';
            setTimeout(() => {
                document.getElementById('addSuccess').style.display = 'none';
            }, 2000);
        }

        function showAddError(msg) {
            document.getElementById('addError').textContent = msg;
            document.getElementById('addError').style.display = 'block';
            document.getElementById('addSuccess').style.display = 'none';
        }

        // ============== æ‰¹é‡å¯¼å…¥ ==============
        let parsedBatchData = [];

        function openBatchImportModal() {
            document.getElementById('batchImportModal').classList.add('active');
            document.getElementById('batchInput').value = '';
            document.getElementById('batchPreview').style.display = 'none';
            document.getElementById('batchStats').style.display = 'none';
            document.getElementById('batchImportBtn').disabled = true;
            document.getElementById('batchSuccess').style.display = 'none';
            document.getElementById('batchError').style.display = 'none';
            parsedBatchData = [];
        }

        function closeBatchImportModal() {
            document.getElementById('batchImportModal').classList.remove('active');
        }

        function parseDate(dateStr) {
            dateStr = dateStr.trim();

            // æ ¼å¼: MMDD (å¦‚ 1220)
            if (/^\d{4}$/.test(dateStr)) {
                return dateStr;
            }

            // æ ¼å¼: MM-DD æˆ– M-D (å¦‚ 12-20 æˆ– 1-5)
            let match = dateStr.match(/^(\d{1,2})-(\d{1,2})$/);
            if (match) {
                return match[1].padStart(2, '0') + match[2].padStart(2, '0');
            }

            // æ ¼å¼: MæœˆDæ—¥ (å¦‚ 12æœˆ20æ—¥)
            match = dateStr.match(/^(\d{1,2})æœˆ(\d{1,2})æ—¥?$/);
            if (match) {
                return match[1].padStart(2, '0') + match[2].padStart(2, '0');
            }

            return null;
        }

        function parseBatchLine(line) {
            line = line.trim();
            if (!line) return null;

            // æ”¯æŒé€—å·æˆ–å¤šä¸ªç©ºæ ¼åˆ†éš”
            const parts = line.split(/[,ï¼Œ]\s*|\s{2,}/).map(p => p.trim()).filter(p => p);

            if (parts.length < 3) return null;

            const name = parts[0];
            const date = parseDate(parts[1]);
            const distance = parseFloat(parts[2]);
            const note = parts[3] || null;

            if (!name || !date || isNaN(distance)) return null;

            return { name, date, distance, unit: 'km', note };
        }

        function previewBatchData() {
            const input = document.getElementById('batchInput').value;
            const lines = input.split('\n');

            parsedBatchData = [];
            let validCount = 0;
            let invalidCount = 0;
            let previewHtml = '';

            lines.forEach((line, index) => {
                if (!line.trim()) return;

                const parsed = parseBatchLine(line);
                if (parsed) {
                    parsedBatchData.push(parsed);
                    validCount++;
                    previewHtml += `<div class="import-preview-item valid">âœ“ ${parsed.name} | ${formatDate(parsed.date)} | ${parsed.distance}km${parsed.note ? ' | ' + parsed.note : ''}</div>`;
                } else {
                    invalidCount++;
                    previewHtml += `<div class="import-preview-item invalid">âœ— ç¬¬${index + 1}è¡Œæ ¼å¼é”™è¯¯: ${line}</div>`;
                }
            });

            document.getElementById('batchPreview').innerHTML = previewHtml || '<div>æ²¡æœ‰å¯é¢„è§ˆçš„æ•°æ®</div>';
            document.getElementById('batchPreview').style.display = 'block';
            document.getElementById('batchStats').innerHTML = `<span>æœ‰æ•ˆ: ${validCount}æ¡</span><span>æ— æ•ˆ: ${invalidCount}æ¡</span>`;
            document.getElementById('batchStats').style.display = 'flex';
            document.getElementById('batchImportBtn').disabled = validCount === 0;
        }

        async function executeBatchImport() {
            if (parsedBatchData.length === 0) return;

            showLoading('æ­£åœ¨å¯¼å…¥æ•°æ®...');

            if (isConnected && supabaseClient) {
                try {
                    const { data, error } = await supabaseClient
                        .from('running_records')
                        .insert(parsedBatchData)
                        .select();

                    if (error) throw error;

                    rawData.push(...data);
                    document.getElementById('batchSuccess').textContent = `æˆåŠŸå¯¼å…¥ ${data.length} æ¡æ•°æ®!`;
                    document.getElementById('batchSuccess').style.display = 'block';

                } catch (err) {
                    document.getElementById('batchError').textContent = 'å¯¼å…¥å¤±è´¥: ' + err.message;
                    document.getElementById('batchError').style.display = 'block';
                    hideLoading();
                    return;
                }
            } else {
                // æœ¬åœ°æ¨¡å¼
                let maxId = rawData.length > 0 ? Math.max(...rawData.map(r => r.id)) : 0;
                parsedBatchData.forEach(record => {
                    record.id = ++maxId;
                    rawData.push(record);
                });
                document.getElementById('batchSuccess').textContent = `æˆåŠŸå¯¼å…¥ ${parsedBatchData.length} æ¡æ•°æ®!`;
                document.getElementById('batchSuccess').style.display = 'block';
            }

            renderAll();
            hideLoading();

            // æ¸…ç©ºå¹¶å…³é—­
            setTimeout(() => {
                closeBatchImportModal();
            }, 1500);
        }

        // ============== æ·»åŠ æ•°æ®å¼¹çª— ==============
        function openAddDataModal() {
            const modal = document.getElementById('addDataModal');
            modal.classList.add('active');

            // å¡«å……äººå‘˜ä¸‹æ‹‰æ¡†
            const select = document.getElementById('inputName');
            const persons = [...new Set(rawData.map(item => item.name))].sort();
            select.innerHTML = '<option value="">-- é€‰æ‹©å·²æœ‰æˆå‘˜ --</option>';
            persons.forEach(person => {
                select.innerHTML += `<option value="${person}">${person}</option>`;
            });

            // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºä»Šå¤©
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('inputDate').value = today;

            // æ¸…ç©ºå…¶ä»–å­—æ®µ
            document.getElementById('inputNewName').value = '';
            document.getElementById('inputDistance').value = '';
            document.getElementById('inputNote').value = '';
            document.getElementById('addSuccess').style.display = 'none';
            document.getElementById('addError').style.display = 'none';
        }

        function closeAddDataModal() {
            document.getElementById('addDataModal').classList.remove('active');
        }

        // ============== å›¾è¡¨å’Œç»Ÿè®¡ ==============
        let weeklyStackedChart = null;
        let weeklyTrendChart = null;
        let totalDistanceChart = null;
        let runCountChart = null;

        const filterState = {
            stacked: {},
            trend: {}
        };

        function formatDate(dateStr) {
            const month = dateStr.substring(0, 2);
            const day = dateStr.substring(2, 4);
            return `${parseInt(month)}æœˆ${parseInt(day)}æ—¥`;
        }

        const personColors = {
            'å¾å²š': '#FF6384',
            'æ–¹æ–‡': '#36A2EB',
            'é™ˆå¾·ç´': '#FFCE56',
            'ææ–‡æ¶›': '#4BC0C0',
            'æ¢æ™¨': '#9966FF',
            'é™ˆå³¥åµ˜': '#FF9F40',
            'chuchu': '#7BC225',
            'å²å­Ÿä¸½': '#E74C3C',
            'å®‰è¿ª': '#3498DB',
            'æ¨é–': '#1ABC9C',
            'å¼ åª›åª›': '#333333',
            'é©¬æ–‡é›…': '#8E44AD'
        };

        function getPersonColor(name) {
            return personColors[name] || '#C9CBCF';
        }

        function calculateStats() {
            if (rawData.length === 0) return { totalDistance: 0, totalRuns: 0, uniqueRunners: 0, avgDistance: 0, maxDistance: 0 };

            const totalDistance = rawData.reduce((sum, item) => sum + item.distance, 0);
            const totalRuns = rawData.length;
            const uniqueRunners = [...new Set(rawData.map(item => item.name))].length;
            const avgDistance = totalDistance / totalRuns;
            const maxDistance = Math.max(...rawData.map(item => item.distance));

            return { totalDistance, totalRuns, uniqueRunners, avgDistance, maxDistance };
        }

        function renderStatsSummary() {
            const stats = calculateStats();
            const container = document.getElementById('statsSummary');

            container.innerHTML = `
                <div class="stat-card">
                    <h3>æ€»é‡Œç¨‹</h3>
                    <div class="value">${stats.totalDistance.toFixed(2)}</div>
                    <div class="unit">å…¬é‡Œ</div>
                </div>
                <div class="stat-card">
                    <h3>è·‘æ­¥æ¬¡æ•°</h3>
                    <div class="value">${stats.totalRuns}</div>
                    <div class="unit">æ¬¡</div>
                </div>
                <div class="stat-card">
                    <h3>å‚ä¸äººæ•°</h3>
                    <div class="value">${stats.uniqueRunners}</div>
                    <div class="unit">äºº</div>
                </div>
                <div class="stat-card">
                    <h3>å¹³å‡æ¯æ¬¡</h3>
                    <div class="value">${stats.avgDistance.toFixed(2)}</div>
                    <div class="unit">å…¬é‡Œ</div>
                </div>
                <div class="stat-card">
                    <h3>å•æ¬¡æœ€é•¿</h3>
                    <div class="value">${stats.maxDistance}</div>
                    <div class="unit">å…¬é‡Œ</div>
                </div>
            `;
        }

        function getPersonalTotals() {
            const totals = {};
            rawData.forEach(item => {
                if (!totals[item.name]) totals[item.name] = 0;
                totals[item.name] += item.distance;
            });
            return Object.entries(totals)
                .sort((a, b) => b[1] - a[1])
                .map(([name, distance]) => ({ name, distance }));
        }

        function getRunCounts() {
            const counts = {};
            rawData.forEach(item => {
                if (!counts[item.name]) counts[item.name] = 0;
                counts[item.name]++;
            });
            return Object.entries(counts)
                .sort((a, b) => b[1] - a[1])
                .map(([name, count]) => ({ name, count }));
        }

        function getWeekNumber(dateStr) {
            const month = parseInt(dateStr.substring(0, 2));
            const day = parseInt(dateStr.substring(2, 4));
            const date = new Date(2025, month - 1, day);

            // 2025å¹´1æœˆ1æ—¥æ˜¯æ˜ŸæœŸä¸‰
            const yearStart = new Date(2025, 0, 1);

            // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ˜ŸæœŸä¸€ï¼š2025å¹´1æœˆ6æ—¥
            const firstMonday = new Date(2025, 0, 6);

            // 1æœˆ1æ—¥åˆ°1æœˆ5æ—¥ç®—ä½œç¬¬1å‘¨
            if (date < firstMonday) {
                return 1;
            }

            // ä»ç¬¬ä¸€ä¸ªå®Œæ•´å‘¨ï¼ˆ1æœˆ6æ—¥å¼€å§‹ï¼‰å¼€å§‹è®¡ç®—
            const daysSinceFirstMonday = Math.floor((date - firstMonday) / 86400000);
            return Math.floor(daysSinceFirstMonday / 7) + 2;
        }

        function getWeeklyDataByPerson() {
            const weeklyData = {};
            const allPersons = [...new Set(rawData.map(item => item.name))];

            const personTotals = {};
            allPersons.forEach(person => personTotals[person] = 0);
            rawData.forEach(item => personTotals[item.name] += item.distance);

            const sortedPersons = allPersons.sort((a, b) => personTotals[b] - personTotals[a]);

            rawData.forEach(item => {
                const weekNum = getWeekNumber(item.date);
                const weekLabel = `ç¬¬${weekNum}å‘¨`;

                if (!weeklyData[weekLabel]) {
                    weeklyData[weekLabel] = {};
                    sortedPersons.forEach(person => weeklyData[weekLabel][person] = 0);
                }
                weeklyData[weekLabel][item.name] += item.distance;
            });

            const sortedWeeks = Object.keys(weeklyData).sort((a, b) => {
                const numA = parseInt(a.match(/\d+/)[0]);
                const numB = parseInt(b.match(/\d+/)[0]);
                return numA - numB;
            });

            return { weeks: sortedWeeks, data: weeklyData, persons: sortedPersons };
        }

        function createFilter(containerId, filterType, persons) {
            const container = document.getElementById(containerId);

            persons.forEach(person => {
                if (filterState[filterType][person] === undefined) {
                    filterState[filterType][person] = true;
                }
            });

            let html = '';
            persons.forEach(person => {
                const checked = filterState[filterType][person] ? 'checked' : '';
                const color = getPersonColor(person);
                html += `
                    <label>
                        <input type="checkbox" data-person="${person}" data-type="${filterType}" ${checked}>
                        <span class="color-dot" style="background: ${color}"></span>
                        ${person}
                    </label>
                `;
            });

            html += `
                <div class="filter-actions">
                    <button class="btn-all" data-type="${filterType}">å…¨é€‰</button>
                    <button class="btn-none" data-type="${filterType}">æ¸…ç©º</button>
                </div>
            `;

            container.innerHTML = html;

            container.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                cb.addEventListener('change', (e) => {
                    filterState[e.target.dataset.type][e.target.dataset.person] = e.target.checked;
                    updateChart(e.target.dataset.type);
                });
            });

            container.querySelector('.btn-all').addEventListener('click', () => {
                persons.forEach(p => filterState[filterType][p] = true);
                container.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = true);
                updateChart(filterType);
            });

            container.querySelector('.btn-none').addEventListener('click', () => {
                persons.forEach(p => filterState[filterType][p] = false);
                container.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                updateChart(filterType);
            });
        }

        function updateChart(type) {
            if (type === 'stacked') renderWeeklyStackedChart();
            else if (type === 'trend') renderWeeklyTrendChart();
        }

        function renderWeeklyStackedChart() {
            if (rawData.length === 0) return;

            const { weeks, data, persons } = getWeeklyDataByPerson();

            if (!document.querySelector('#stackedFilter input')) {
                createFilter('stackedFilter', 'stacked', persons);
            }

            const filteredPersons = persons.filter(p => filterState.stacked[p]);
            const ctx = document.getElementById('weeklyStackedChart').getContext('2d');

            if (weeklyStackedChart) weeklyStackedChart.destroy();

            const datasets = filteredPersons.map(person => ({
                label: person,
                data: weeks.map(week => data[week][person]),
                backgroundColor: getPersonColor(person),
                borderColor: getPersonColor(person),
                borderWidth: 1,
                borderRadius: 4
            }));

            weeklyStackedChart = new Chart(ctx, {
                type: 'bar',
                data: { labels: weeks, datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: ctx => ctx.raw === 0 ? null : `${ctx.dataset.label}: ${ctx.raw.toFixed(2)} km`,
                                footer: items => `æœ¬å‘¨æ€»è®¡: ${items.reduce((s, i) => s + i.raw, 0).toFixed(2)} km`
                            }
                        }
                    },
                    scales: {
                        x: { stacked: true, title: { display: true, text: 'å‘¨æ¬¡' } },
                        y: { stacked: true, beginAtZero: true, title: { display: true, text: 'å…¬é‡Œ (km)' } }
                    }
                }
            });
        }

        function renderTotalDistanceChart() {
            if (rawData.length === 0) return;

            const data = getPersonalTotals();
            const ctx = document.getElementById('totalDistanceChart').getContext('2d');

            if (totalDistanceChart) totalDistanceChart.destroy();

            totalDistanceChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(d => d.name),
                    datasets: [{
                        label: 'æ€»é‡Œç¨‹ (km)',
                        data: data.map(d => d.distance),
                        backgroundColor: data.map(d => getPersonColor(d.name)),
                        borderRadius: 8,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'å…¬é‡Œ (km)' } } }
                }
            });
        }

        function renderRunCountChart() {
            if (rawData.length === 0) return;

            const data = getRunCounts();
            const ctx = document.getElementById('runCountChart').getContext('2d');

            if (runCountChart) runCountChart.destroy();

            runCountChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(d => d.name),
                    datasets: [{
                        label: 'è·‘æ­¥æ¬¡æ•°',
                        data: data.map(d => d.count),
                        backgroundColor: data.map(d => getPersonColor(d.name) + '99'),
                        borderColor: data.map(d => getPersonColor(d.name)),
                        borderWidth: 2,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: { legend: { display: false } },
                    scales: { x: { beginAtZero: true, ticks: { stepSize: 1 }, title: { display: true, text: 'æ¬¡æ•°' } } }
                }
            });
        }

        function renderWeeklyTrendChart() {
            if (rawData.length === 0) return;

            const { weeks, data, persons } = getWeeklyDataByPerson();

            if (!document.querySelector('#trendFilter input')) {
                createFilter('trendFilter', 'trend', persons);
            }

            const filteredPersons = persons.filter(p => filterState.trend[p]);
            const ctx = document.getElementById('weeklyTrendChart').getContext('2d');

            if (weeklyTrendChart) weeklyTrendChart.destroy();

            const datasets = filteredPersons.map(person => ({
                label: person,
                data: weeks.map(week => data[week][person] || 0),
                borderColor: getPersonColor(person),
                backgroundColor: getPersonColor(person) + '33',
                fill: false,
                tension: 0.3,
                pointRadius: 6,
                pointHoverRadius: 8,
                pointBackgroundColor: getPersonColor(person),
                borderWidth: 3
            }));

            weeklyTrendChart = new Chart(ctx, {
                type: 'line',
                data: { labels: weeks, datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: ctx => ctx.raw === 0 ? `${ctx.dataset.label}: æœªè·‘æ­¥` : `${ctx.dataset.label}: ${ctx.raw.toFixed(2)} km`
                            }
                        }
                    },
                    scales: {
                        x: { title: { display: true, text: 'å‘¨æ¬¡' } },
                        y: { beginAtZero: true, title: { display: true, text: 'å…¬é‡Œ (km)' } }
                    }
                }
            });
        }

        // ============== æ•°æ®è¡¨æ ¼å’Œç­›é€‰ ==============
        let currentMonthFilter = 'all';
        let currentPersonFilter = 'all';

        function getMonthName(monthNum) {
            const months = { '01': '1æœˆ', '02': '2æœˆ', '03': '3æœˆ', '04': '4æœˆ', '05': '5æœˆ', '06': '6æœˆ', '07': '7æœˆ', '08': '8æœˆ', '09': '9æœˆ', '10': '10æœˆ', '11': '11æœˆ', '12': '12æœˆ' };
            return months[monthNum] || monthNum + 'æœˆ';
        }

        function createMonthFilter() {
            const container = document.getElementById('monthFilter');
            const months = [...new Set(rawData.map(item => item.date.substring(0, 2)))].sort();

            let html = '<button class="active" data-month="all">å…¨éƒ¨</button>';
            months.forEach(month => html += `<button data-month="${month}">${getMonthName(month)}</button>`);

            container.innerHTML = html;

            container.querySelectorAll('button').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    container.querySelectorAll('button').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentMonthFilter = e.target.dataset.month;
                    renderDataTable();
                });
            });
        }

        function createPersonFilter() {
            const container = document.getElementById('personFilter');
            const persons = [...new Set(rawData.map(item => item.name))].sort();

            let html = '<button class="active" data-person="all">å…¨éƒ¨æˆå‘˜</button>';
            persons.forEach(person => html += `<button data-person="${person}">${person}</button>`);

            container.innerHTML = html;

            container.querySelectorAll('button').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    container.querySelectorAll('button').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentPersonFilter = e.target.dataset.person;
                    renderDataTable();
                });
            });
        }

        function renderDataTable() {
            const tbody = document.querySelector('#dataTable tbody');
            tbody.innerHTML = '';

            let filteredData = rawData;
            if (currentMonthFilter !== 'all') {
                filteredData = filteredData.filter(item => item.date.substring(0, 2) === currentMonthFilter);
            }
            if (currentPersonFilter !== 'all') {
                filteredData = filteredData.filter(item => item.name === currentPersonFilter);
            }

            filteredData.forEach(item => {
                const row = document.createElement('tr');
                if (item.note) row.classList.add('highlight');
                row.innerHTML = `
                    <td>${item.id}</td>
                    <td>${item.name}</td>
                    <td>2025å¹´${formatDate(item.date)}</td>
                    <td>${item.distance.toFixed(2)}</td>
                    <td>${item.note || '-'}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // ============== ç›®æ ‡å’Œå¥–ç‰Œç»Ÿè®¡ ==============
        function getWeeklyGoalStats() {
            const { weeks, data, persons } = getWeeklyDataByPerson();
            const goalCounts = {};

            persons.forEach(person => {
                goalCounts[person] = 0;
                weeks.forEach(week => {
                    if (data[week][person] >= 3) goalCounts[person]++;
                });
            });

            return Object.entries(goalCounts)
                .filter(([name, count]) => count > 0)
                .sort((a, b) => b[1] - a[1])
                .map(([name, count]) => ({ name, count }));
        }

        function renderWeeklyGoalStats() {
            const data = getWeeklyGoalStats();
            document.getElementById('weeklyGoalStats').innerHTML = data.map(d => `
                <div class="goal-card">
                    <div class="name">${d.name}</div>
                    <div class="count">${d.count}</div>
                    <div class="label">å‘¨è¾¾æ ‡</div>
                </div>
            `).join('');
        }

        function getMonthlyMedals() {
            const monthlyData = {};
            const months = [...new Set(rawData.map(item => item.date.substring(0, 2)))].sort();

            months.forEach(month => monthlyData[month] = {});

            rawData.forEach(item => {
                const month = item.date.substring(0, 2);
                if (!monthlyData[month][item.name]) monthlyData[month][item.name] = 0;
                monthlyData[month][item.name] += item.distance;
            });

            const monthlyRankings = {};
            months.forEach(month => {
                monthlyRankings[month] = Object.entries(monthlyData[month])
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 3)
                    .map(([name, distance], index) => ({
                        name,
                        distance,
                        medal: index === 0 ? 'ğŸ…' : index === 1 ? 'ğŸ¥ˆ' : 'ğŸ¥‰'
                    }));
            });

            return { months, rankings: monthlyRankings };
        }

        function getMedalSummary() {
            const { months, rankings } = getMonthlyMedals();
            const medalCounts = {};

            months.forEach(month => {
                rankings[month].forEach((entry, index) => {
                    if (!medalCounts[entry.name]) medalCounts[entry.name] = { gold: 0, silver: 0, bronze: 0 };
                    if (index === 0) medalCounts[entry.name].gold++;
                    else if (index === 1) medalCounts[entry.name].silver++;
                    else if (index === 2) medalCounts[entry.name].bronze++;
                });
            });

            return Object.entries(medalCounts)
                .map(([name, medals]) => ({
                    name,
                    ...medals,
                    total: medals.gold * 3 + medals.silver * 2 + medals.bronze
                }))
                .sort((a, b) => b.total - a.total || b.gold - a.gold || b.silver - a.silver);
        }

        function renderMonthlyMedals() {
            const { months, rankings } = getMonthlyMedals();
            document.getElementById('monthlyMedals').innerHTML = months.map(month => `
                <div class="month-medal-card">
                    <h3>${getMonthName(month)}</h3>
                    ${rankings[month].map(entry => `
                        <div class="medal-row">
                            <span class="medal-icon">${entry.medal}</span>
                            <span class="medal-name">${entry.name}</span>
                            <span class="medal-distance">${entry.distance.toFixed(2)} km</span>
                        </div>
                    `).join('')}
                </div>
            `).join('');
        }

        function renderMedalSummary() {
            const data = getMedalSummary();
            document.getElementById('medalSummary').innerHTML = data.map(d => `
                <div class="medal-summary-card">
                    <div class="name">${d.name}</div>
                    <div class="medals">${'ğŸ…'.repeat(d.gold)}${'ğŸ¥ˆ'.repeat(d.silver)}${'ğŸ¥‰'.repeat(d.bronze)}</div>
                    <div class="total">${d.gold}é‡‘ ${d.silver}é“¶ ${d.bronze}é“œ</div>
                </div>
            `).join('');
        }

        // ============== å…¶ä»–åŠŸèƒ½ ==============
        function toggleDataTable() {
            const header = document.querySelector('.collapsible-header');
            const content = document.getElementById('dataTableContent');

            header.classList.toggle('collapsed');
            content.classList.toggle('collapsed');

            if (!content.classList.contains('collapsed')) {
                content.style.maxHeight = content.scrollHeight + 'px';
            } else {
                content.style.maxHeight = '0';
            }
        }

        function exportToImage() {
            const btn = document.querySelector('.export-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = 'â³ å¯¼å‡ºä¸­...';
            btn.disabled = true;

            btn.style.display = 'none';
            document.querySelector('.add-data-btn').style.display = 'none';
            document.querySelector('.batch-import-btn').style.display = 'none';
            document.querySelector('.config-btn').style.display = 'none';
            document.getElementById('connectionStatus').style.display = 'none';

            html2canvas(document.getElementById('mainContainer'), {
                backgroundColor: null,
                scale: 2,
                useCORS: true,
                logging: false
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `è·‘æ­¥æ•°æ®ç»Ÿè®¡_${new Date().toLocaleDateString('zh-CN').replace(/\//g, '-')}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();

                btn.style.display = 'block';
                document.querySelector('.add-data-btn').style.display = 'block';
                document.querySelector('.batch-import-btn').style.display = 'block';
                document.querySelector('.config-btn').style.display = 'block';
                document.getElementById('connectionStatus').style.display = 'block';
                btn.innerHTML = originalText;
                btn.disabled = false;
            }).catch(err => {
                console.error('å¯¼å‡ºå¤±è´¥:', err);
                alert('å¯¼å‡ºå¤±è´¥ï¼Œè¯·é‡è¯•');
                btn.style.display = 'block';
                document.querySelector('.add-data-btn').style.display = 'block';
                document.querySelector('.batch-import-btn').style.display = 'block';
                document.querySelector('.config-btn').style.display = 'block';
                document.getElementById('connectionStatus').style.display = 'block';
                btn.innerHTML = originalText;
                btn.disabled = false;
            });
        }

        // ============== å¹´ç»ˆæ€»ç»“åŠŸèƒ½ ==============
        let personalMonthlyChart = null;

        // è®¡ç®—ä¸ªäººå¹´åº¦ç»Ÿè®¡
        function getPersonalYearSummary(name) {
            const personData = rawData.filter(item => item.name === name);

            if (personData.length === 0) {
                return null;
            }

            const totalDistance = personData.reduce((sum, item) => sum + item.distance, 0);
            const totalRuns = personData.length;
            const avgDistance = totalDistance / totalRuns;
            const maxDistance = Math.max(...personData.map(item => item.distance));

            // æ´»è·ƒæœˆä»½æ•°
            const activeMonths = [...new Set(personData.map(item => item.date.substring(0, 2)))].length;

            // æœˆåº¦æ•°æ®
            const monthlyData = {};
            personData.forEach(item => {
                const month = item.date.substring(0, 2);
                if (!monthlyData[month]) monthlyData[month] = { distance: 0, count: 0 };
                monthlyData[month].distance += item.distance;
                monthlyData[month].count++;
            });

            // æœ€ä½³æœˆä»½ï¼ˆé‡Œç¨‹æœ€å¤šï¼‰
            let bestMonth = '';
            let maxMonthDistance = 0;
            Object.entries(monthlyData).forEach(([month, data]) => {
                if (data.distance > maxMonthDistance) {
                    maxMonthDistance = data.distance;
                    bestMonth = month;
                }
            });

            // æœ€æ´»è·ƒæœˆä»½ï¼ˆæ¬¡æ•°æœ€å¤šï¼‰
            let mostActiveMonth = '';
            let maxMonthCount = 0;
            Object.entries(monthlyData).forEach(([month, data]) => {
                if (data.count > maxMonthCount) {
                    maxMonthCount = data.count;
                    mostActiveMonth = month;
                }
            });

            // å¥–ç‰Œæ•°ç»Ÿè®¡
            const { months, rankings } = getMonthlyMedals();
            let medalCount = 0;
            months.forEach(month => {
                rankings[month].forEach(entry => {
                    if (entry.name === name) medalCount++;
                });
            });

            // è¾¾æ ‡å‘¨æ•°
            const { weeks, data } = getWeeklyDataByPerson();
            let goalWeeks = 0;
            weeks.forEach(week => {
                if (data[week][name] >= 3) goalWeeks++;
            });

            return {
                totalDistance,
                totalRuns,
                avgDistance,
                maxDistance,
                activeMonths,
                monthlyData,
                bestMonth,
                mostActiveMonth,
                medalCount,
                goalWeeks
            };
        }

        // åœ°æ ‡å¯¹æ¯”æ•°æ®åº“
        const landmarks = [
            { distance: 10, text: 'è¿™ç›¸å½“äºåœ¨è¥¿æ¹–è¾¹è·‘äº†ä¸€åœˆï¼Œæ„Ÿå—åˆ°äº†æ¹–å…‰å±±è‰²ï¼' },
            { distance: 21, text: 'å“‡ï¼ä½ å·²ç»è·‘å®Œäº†ä¸€ä¸ªåŠç¨‹é©¬æ‹‰æ¾çš„è·ç¦»ï¼' },
            { distance: 42, text: 'å…¨ç¨‹é©¬æ‹‰æ¾ï¼ä½ çš„è€åŠ›å·²ç»è¾¾åˆ°äº†ä¸“ä¸šæ°´å¹³ï¼' },
            { distance: 50, text: 'ç›¸å½“äºä»æ­å·è¥¿æ¹–è·‘åˆ°é’±å¡˜æ±Ÿå¾€è¿”ï¼Œè¿™æ¯…åŠ›è®©äººä½©æœï¼' },
            { distance: 100, text: 'ç›¸å½“äºä»åŒ—äº¬å¤©å®‰é—¨è·‘åˆ°å¤©æ´¥ï¼Œä½ ç®€ç›´æ˜¯è¶…äººï¼' },
            { distance: 150, text: 'ç›¸å½“äºä»ä¸Šæµ·äººæ°‘å¹¿åœºè·‘åˆ°è‹å·ï¼Œè¿™å·²ç»æ˜¯ä¸€åœºåŸé™…æ—…è¡Œäº†ï¼' },
            { distance: 200, text: 'ç›¸å½“äºä»ä¸Šæµ·è·‘åˆ°æ­å·ï¼Œä½ çš„è¶³è¿¹è·¨è¶Šäº†åŸå¸‚ï¼' },
            { distance: 300, text: 'ç›¸å½“äºä»åŒ—äº¬è·‘åˆ°æµå—ï¼Œè¿™è·ç¦»è¶³ä»¥è®©ä»»ä½•äººæƒŠå¹ï¼' },
            { distance: 500, text: 'ç›¸å½“äºä»åŒ—äº¬è·‘åˆ°å—äº¬ï¼Œä½ å·²ç»å¾æœäº†å¤§åŠä¸ªä¸­å›½ï¼' },
            { distance: 800, text: 'ç›¸å½“äºä»ä¸Šæµ·è·‘åˆ°æ­¦æ±‰ï¼Œé•¿æ±Ÿéƒ½ä¸ºä½ çš„åšæŒé¼“æŒï¼' },
            { distance: 1000, text: 'ç›¸å½“äºä»å“ˆå°”æ»¨è·‘åˆ°ä¸Šæµ·ï¼Œä½ è·¨è¶Šäº†æ•´ä¸ªä¸­å›½ï¼' },
            { distance: 1500, text: 'ç›¸å½“äºä»åŒ—äº¬è·‘åˆ°å¹¿å·å†è¿”å›éƒ‘å·ï¼Œè¿™æ˜¯å²è¯—çº§çš„æˆå°±ï¼' },
            { distance: 2000, text: 'ç›¸å½“äºä»åŒ—äº¬è·‘åˆ°å¹¿å·å†å¾€è¿”ï¼Œä½ ç®€ç›´æ˜¯è·‘æ­¥ä¼ å¥‡ï¼' },
            { distance: 3000, text: 'ç›¸å½“äºæ¨ªè·¨ä¸­å›½ä¸‰ä¸ªæ¥å›ï¼Œä½ çš„æ¯…åŠ›æ— äººèƒ½åŠï¼' },
            { distance: 5000, text: 'è¿™ä¸ªè·ç¦»å¯ä»¥ä»åŒ—äº¬è·‘åˆ°æ‹‰è¨å†è¿”å›ï¼Œä½ æ˜¯çœŸæ­£çš„è·‘è€…ï¼' }
        ];

        // è·å–åœ°æ ‡å¯¹æ¯”
        function getMilestoneLandmark(distance) {
            for (let i = landmarks.length - 1; i >= 0; i--) {
                if (distance >= landmarks[i].distance) {
                    return landmarks[i].text;
                }
            }
            return 'åˆšåˆšå¼€å§‹ä½ çš„è·‘æ­¥æ—…ç¨‹ï¼Œç»§ç»­åŠ æ²¹ï¼';
        }

        // è®¡ç®—åœ°çƒå‘¨é•¿è¿›åº¦
        function getEarthProgress(distance) {
            const earthCircumference = 40075; // åœ°çƒèµ¤é“å‘¨é•¿ï¼ˆå…¬é‡Œï¼‰
            const percentage = (distance / earthCircumference * 100).toFixed(2);
            const yearsToComplete = distance > 0 ? (earthCircumference / distance).toFixed(1) : '-';

            return {
                percentage,
                yearsToComplete,
                circumference: earthCircumference
            };
        }

        // ç”Ÿæˆå½©è™¹å±æ–‡æ¡ˆ
        function generateEncouragingText(stats) {
            const texts = [];

            // æ ¹æ®æ€»é‡Œç¨‹ç”Ÿæˆæ–‡æ¡ˆ
            if (stats.totalDistance > 1000) {
                texts.push(`å“‡ï¼<span class="highlight">${stats.totalDistance.toFixed(2)}å…¬é‡Œ</span>ï¼ä½ æ˜¯çœŸæ­£çš„è·‘æ­¥è¾¾äººï¼è¿™ä¸€å¹´çš„åšæŒè¶³ä»¥è®©ä»»ä½•äººæƒŠå¹ï¼Œä½ å·²ç»è¶…è¶Šäº†99%çš„äººï¼`);
            } else if (stats.totalDistance > 500) {
                texts.push(`å¤ªæ£’äº†ï¼<span class="highlight">${stats.totalDistance.toFixed(2)}å…¬é‡Œ</span>çš„æ€»é‡Œç¨‹ï¼Œç›¸å½“äºä»åŒ—äº¬è·‘åˆ°äº†å—äº¬ï¼ä½ çš„æ¯…åŠ›ä»¤äººé’¦ä½©ï¼`);
            } else if (stats.totalDistance > 300) {
                texts.push(`<span class="highlight">${stats.totalDistance.toFixed(2)}å…¬é‡Œ</span>ï¼è¿™ä¸ªæˆç»©å·²ç»è¶…è¿‡äº†å¤§å¤šæ•°äººï¼Œä½ çš„åšæŒå€¼å¾—æ‰€æœ‰æŒå£°ï¼`);
            } else if (stats.totalDistance > 100) {
                texts.push(`<span class="highlight">${stats.totalDistance.toFixed(2)}å…¬é‡Œ</span>çš„æˆç»©éå¸¸æ£’ï¼æ¯ä¸€æ­¥éƒ½æ˜¯å¯¹è‡ªå·±çš„çªç ´ï¼`);
            } else {
                texts.push(`<span class="highlight">${stats.totalDistance.toFixed(2)}å…¬é‡Œ</span>æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼€å§‹ï¼åšæŒä¸‹å»ï¼Œæ˜å¹´ä¼šæ›´å¥½ï¼`);
            }

            // æ ¹æ®æ´»è·ƒæœˆä»½ç”Ÿæˆæ–‡æ¡ˆ
            if (stats.activeMonths >= 10) {
                texts.push(`å…¨å¹´<span class="highlight">${stats.activeMonths}ä¸ªæœˆ</span>éƒ½åœ¨åšæŒï¼Œä½ çš„è‡ªå¾‹ç¨‹åº¦å·²ç»è¾¾åˆ°äº†é¡¶çº§æ°´å¹³ï¼è¿™æ ·çš„æ¯…åŠ›ï¼Œæœªæ¥ä¸€å®šæ— é™å¯èƒ½ï¼`);
            } else if (stats.activeMonths >= 6) {
                texts.push(`<span class="highlight">${stats.activeMonths}ä¸ªæœˆ</span>çš„åšæŒï¼Œè¯´æ˜è·‘æ­¥å·²ç»æˆä¸ºä½ ç”Ÿæ´»çš„ä¸€éƒ¨åˆ†ï¼ç»§ç»­ä¿æŒè¿™ä»½çƒ­çˆ±ï¼`);
            }

            // æ ¹æ®å•æ¬¡æœ€é•¿è·ç¦»ç”Ÿæˆæ–‡æ¡ˆ
            if (stats.maxDistance >= 42) {
                texts.push(`å•æ¬¡<span class="highlight">${stats.maxDistance}å…¬é‡Œ</span>ï¼å…¨é©¬çº§åˆ«ï¼ä½ çš„è€åŠ›å’Œæ„å¿—åŠ›å·²ç»è¾¾åˆ°äº†ä»¤äººæ•¬ä½©çš„é«˜åº¦ï¼`);
            } else if (stats.maxDistance >= 21) {
                texts.push(`å•æ¬¡<span class="highlight">${stats.maxDistance}å…¬é‡Œ</span>ï¼åŠé©¬çº§åˆ«ï¼è¿™ä¸ªè·ç¦»è¶³ä»¥è¯æ˜ä½ çš„å®åŠ›ï¼`);
            } else if (stats.maxDistance >= 10) {
                texts.push(`å•æ¬¡<span class="highlight">${stats.maxDistance}å…¬é‡Œ</span>ï¼çªç ´10å…¬é‡Œå¤§å…³ï¼Œä½ å·²ç»æ˜¯ä¸­é•¿è·‘é«˜æ‰‹äº†ï¼`);
            }

            // æ ¹æ®å¥–ç‰Œæ•°ç”Ÿæˆæ–‡æ¡ˆ
            if (stats.medalCount > 5) {
                texts.push(`è·å¾—äº†<span class="highlight">${stats.medalCount}æš</span>æœˆåº¦å¥–ç‰Œï¼ä½ ç®€ç›´æ˜¯è·‘å›¢çš„ä¸­æµç ¥æŸ±ï¼`);
            } else if (stats.medalCount > 0) {
                texts.push(`è·å¾—äº†<span class="highlight">${stats.medalCount}æš</span>æœˆåº¦å¥–ç‰Œï¼æ¯ä¸€æšéƒ½æ˜¯æ±—æ°´ä¸åšæŒçš„è§è¯ï¼`);
            }

            // æ ¹æ®è·‘æ­¥æ¬¡æ•°ç”Ÿæˆæ–‡æ¡ˆ
            if (stats.totalRuns > 100) {
                texts.push(`å…¨å¹´<span class="highlight">${stats.totalRuns}æ¬¡</span>è·‘æ­¥ï¼å¹³å‡æ¯3å¤©å°±è·‘ä¸€æ¬¡ï¼Œè¿™ä»½è§„å¾‹è®©äººèµå¹ï¼`);
            } else if (stats.totalRuns > 50) {
                texts.push(`<span class="highlight">${stats.totalRuns}æ¬¡</span>è·‘æ­¥è®°å½•ï¼Œè¯´æ˜ä½ çœŸæ­£çƒ­çˆ±è¿™é¡¹è¿åŠ¨ï¼`);
            }

            // æ€»ç»“æ€§æ–‡æ¡ˆ
            texts.push(`2025å¹´ï¼Œä½ ç”¨<span class="highlight">${stats.totalRuns}æ¬¡</span>å¥”è·‘ï¼Œä¹¦å†™äº†å±äºè‡ªå·±çš„ç²¾å½©ï¼æ¯ä¸€æ»´æ±—æ°´éƒ½ä¸ä¼šç™½æµï¼Œæ¯ä¸€æ­¥éƒ½åœ¨è®©ä½ å˜å¾—æ›´å¥½ã€‚2026å¹´ï¼Œè®©æˆ‘ä»¬ä¸€èµ·è·‘å¾—æ›´è¿œã€æ›´å¿«ã€æ›´å¼ºï¼ğŸ’ª`);

            return texts;
        }

        // æ¸²æŸ“ä¸ªäººæœˆåº¦é‡Œç¨‹å›¾è¡¨
        function renderPersonalMonthlyChart(name) {
            const stats = getPersonalYearSummary(name);
            if (!stats) return;

            const ctx = document.getElementById('personalMonthlyChart').getContext('2d');

            if (personalMonthlyChart) personalMonthlyChart.destroy();

            // å‡†å¤‡æ•°æ®
            const months = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'];
            const monthNames = months.map(m => getMonthName(m));
            const distances = months.map(m => stats.monthlyData[m]?.distance || 0);

            personalMonthlyChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: monthNames,
                    datasets: [{
                        label: 'æœˆåº¦é‡Œç¨‹ (km)',
                        data: distances,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 6,
                        pointHoverRadius: 8,
                        pointBackgroundColor: '#667eea',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: (ctx) => `é‡Œç¨‹: ${ctx.raw.toFixed(2)} km`
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'å…¬é‡Œ (km)' },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // æ˜¾ç¤ºå¹´ç»ˆæ€»ç»“
        function showYearSummary() {
            const selector = document.getElementById('yearSummarySelector');
            const name = selector.value;

            if (!name) {
                document.getElementById('yearSummaryContent').classList.remove('active');
                return;
            }

            const stats = getPersonalYearSummary(name);
            if (!stats) {
                alert('æœªæ‰¾åˆ°è¯¥æˆå‘˜çš„æ•°æ®');
                return;
            }

            // æ˜¾ç¤ºå†…å®¹åŒºåŸŸ
            document.getElementById('yearSummaryContent').classList.add('active');

            // æ›´æ–°åŸºç¡€å¡ç‰‡
            document.getElementById('totalDistanceValue').textContent = stats.totalDistance.toFixed(2);
            document.getElementById('totalRunsValue').textContent = stats.totalRuns;
            document.getElementById('activeMonthsValue').textContent = stats.activeMonths;
            document.getElementById('avgDistanceValue').textContent = stats.avgDistance.toFixed(2);
            document.getElementById('maxDistanceValue').textContent = stats.maxDistance.toFixed(2);

            // æ›´æ–°åœ°æ ‡å¯¹æ¯”
            document.getElementById('landmarkDistance').textContent = `${stats.totalDistance.toFixed(2)} å…¬é‡Œ`;
            document.getElementById('landmarkText').textContent = getMilestoneLandmark(stats.totalDistance);

            // æ›´æ–°åœ°çƒè¿›åº¦
            const earthProgress = getEarthProgress(stats.totalDistance);
            document.getElementById('earthPercentage').textContent = earthProgress.percentage + '%';
            document.getElementById('yearsToEarth').textContent = earthProgress.yearsToComplete;

            // ç»˜åˆ¶è¿›åº¦ç¯
            const circle = document.getElementById('earthProgressCircle');
            const radius = 85;
            const circumference = 2 * Math.PI * radius;
            const offset = circumference - (parseFloat(earthProgress.percentage) / 100 * circumference);
            circle.style.strokeDasharray = `${circumference} ${circumference}`;
            circle.style.strokeDashoffset = offset;

            // æ›´æ–°é«˜å…‰æ—¶åˆ»
            document.getElementById('medalCount').textContent = stats.medalCount;
            document.getElementById('goalWeeks').textContent = stats.goalWeeks;
            document.getElementById('bestMonth').textContent = getMonthName(stats.bestMonth);
            document.getElementById('mostActiveMonth').textContent = getMonthName(stats.mostActiveMonth);

            // ç”Ÿæˆå½©è™¹å±
            const encouragingTexts = generateEncouragingText(stats);
            document.getElementById('encouragementTexts').innerHTML = encouragingTexts
                .map(text => `<div class="encouragement-text">${text}</div>`)
                .join('');

            // æ¸²æŸ“æœˆåº¦å›¾è¡¨
            renderPersonalMonthlyChart(name);

            // æ»šåŠ¨åˆ°å¹´ç»ˆæ€»ç»“åŒºåŸŸ
            document.querySelector('.year-summary-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // åˆå§‹åŒ–å¹´ç»ˆæ€»ç»“é€‰æ‹©å™¨
        function initYearSummarySelector() {
            const selector = document.getElementById('yearSummarySelector');
            const persons = [...new Set(rawData.map(item => item.name))].sort();

            selector.innerHTML = '<option value="">ğŸƒ é€‰æ‹©ä½ çš„åå­—ï¼ŒæŸ¥çœ‹ä¸“å±å¹´ç»ˆæŠ¥å‘Š ğŸƒ</option>';
            persons.forEach(person => {
                selector.innerHTML += `<option value="${person}">${person}</option>`;
            });
        }

        // å¯¼å‡ºå¹´ç»ˆæ€»ç»“ä¸ºå›¾ç‰‡
        function exportYearSummary() {
            const selector = document.getElementById('yearSummarySelector');
            const name = selector.value;

            if (!name) {
                alert('è¯·å…ˆé€‰æ‹©ä½ çš„åå­—æŸ¥çœ‹å¹´ç»ˆæ€»ç»“');
                return;
            }

            const yearSummaryContent = document.getElementById('yearSummaryContent');
            if (!yearSummaryContent.classList.contains('active')) {
                alert('è¯·å…ˆæŸ¥çœ‹å¹´ç»ˆæ€»ç»“');
                return;
            }

            // éšè—æ‰€æœ‰å¯èƒ½é®æŒ¡çš„å…ƒç´ 
            const exportBtn = event.target;
            const selectorContainer = document.querySelector('.person-selector-container');
            const addBtn = document.querySelector('.add-data-btn');
            const batchBtn = document.querySelector('.batch-import-btn');
            const exportMainBtn = document.querySelector('.export-btn');
            const configBtn = document.querySelector('.config-btn');
            const connectionStatus = document.getElementById('connectionStatus');

            // ä¿å­˜åŸå§‹æ˜¾ç¤ºçŠ¶æ€
            const originalDisplays = {
                exportBtn: exportBtn.style.display,
                selector: selectorContainer.style.display,
                add: addBtn.style.display,
                batch: batchBtn.style.display,
                exportMain: exportMainBtn.style.display,
                config: configBtn.style.display,
                status: connectionStatus.style.display
            };

            // éšè—æ‰€æœ‰å…ƒç´ 
            exportBtn.style.display = 'none';
            selectorContainer.style.display = 'none';
            addBtn.style.display = 'none';
            batchBtn.style.display = 'none';
            exportMainBtn.style.display = 'none';
            configBtn.style.display = 'none';
            connectionStatus.style.display = 'none';

            // å¼ºåˆ¶ç¡®ä¿å†…å®¹å¯è§(åœ¨åŸå§‹ DOM ä¸Šæ“ä½œ,ç§»é™¤åŠ¨ç”»)
            yearSummaryContent.style.display = 'block';
            yearSummaryContent.style.opacity = '1';
            yearSummaryContent.style.transform = 'none';
            yearSummaryContent.style.animation = 'none';

            // æ˜¾ç¤ºåŠ è½½æç¤º
            showLoading('æ­£åœ¨ç”Ÿæˆå›¾ç‰‡ï¼Œè¯·ç¨å€™...');

            // å…ˆæ»šåŠ¨åˆ°å…ƒç´ ä½ç½®,ç¡®ä¿å®Œå…¨å¯è§
            document.getElementById('yearSummarySection').scrollIntoView({ behavior: 'auto', block: 'start' });

            // ç­‰å¾…800msè®© DOM å®Œå…¨æ›´æ–°å’Œæ¸²æŸ“,ç„¶åè¿›è¡Œæˆªå›¾
            setTimeout(() => {
                html2canvas(document.getElementById('yearSummarySection'), {
                    backgroundColor: null,
                    scale: 2,
                    useCORS: true,
                    logging: true,
                    allowTaint: false
                }).then(canvas => {
                    // æ£€æŸ¥canvasæ˜¯å¦æœ‰æ•ˆ
                    if (!canvas || canvas.width === 0 || canvas.height === 0) {
                        console.error('Canvas is empty or invalid');
                        hideLoading();
                        alert('å¯¼å‡ºå¤±è´¥ï¼šæ— æ³•ç”Ÿæˆå›¾ç‰‡å†…å®¹ï¼Œè¯·é‡è¯•');
                        // æ¢å¤æ˜¾ç¤º
                        exportBtn.style.display = originalDisplays.exportBtn || 'block';
                        selectorContainer.style.display = originalDisplays.selector || 'block';
                        addBtn.style.display = originalDisplays.add || 'block';
                        batchBtn.style.display = originalDisplays.batch || 'block';
                        exportMainBtn.style.display = originalDisplays.exportMain || 'block';
                        configBtn.style.display = originalDisplays.config || 'block';
                        connectionStatus.style.display = originalDisplays.status || 'block';
                        return;
                    }

                    const link = document.createElement('a');
                    const date = new Date().toLocaleDateString('zh-CN').replace(/\//g, '-');
                    link.download = `${name}_2025å¹´ç»ˆè·‘æ­¥æ€»ç»“_${date}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();

                    hideLoading();

                    // æ¢å¤æ˜¾ç¤º(ä½†ä¿æŒå†…å®¹å¯è§ï¼Œä¸æ¢å¤åŠ¨ç”»)
                    exportBtn.style.display = originalDisplays.exportBtn || 'block';
                    selectorContainer.style.display = originalDisplays.selector || 'block';
                    addBtn.style.display = originalDisplays.add || 'block';
                    batchBtn.style.display = originalDisplays.batch || 'block';
                    exportMainBtn.style.display = originalDisplays.exportMain || 'block';
                    configBtn.style.display = originalDisplays.config || 'block';
                    connectionStatus.style.display = originalDisplays.status || 'block';
                }).catch(err => {
                    console.error('å¯¼å‡ºå¤±è´¥:', err);
                    hideLoading();
                    alert('å¯¼å‡ºå¤±è´¥: ' + err.message + 'ï¼Œè¯·é‡è¯•');

                    // æ¢å¤æ˜¾ç¤º(ä½†ä¿æŒå†…å®¹å¯è§ï¼Œä¸æ¢å¤åŠ¨ç”»)
                    exportBtn.style.display = originalDisplays.exportBtn || 'block';
                    selectorContainer.style.display = originalDisplays.selector || 'block';
                    addBtn.style.display = originalDisplays.add || 'block';
                    batchBtn.style.display = originalDisplays.batch || 'block';
                    exportMainBtn.style.display = originalDisplays.exportMain || 'block';
                    configBtn.style.display = originalDisplays.config || 'block';
                    connectionStatus.style.display = originalDisplays.status || 'block';
                });
            }, 800);
        }

        // æ¸²æŸ“æ‰€æœ‰å†…å®¹
        function renderAll() {
            // é‡ç½®ç­›é€‰å™¨çŠ¶æ€
            filterState.stacked = {};
            filterState.trend = {};
            document.getElementById('stackedFilter').innerHTML = '';
            document.getElementById('trendFilter').innerHTML = '';

            renderStatsSummary();
            renderWeeklyGoalStats();
            renderMonthlyMedals();
            renderMedalSummary();
            renderWeeklyStackedChart();
            renderTotalDistanceChart();
            renderRunCountChart();
            renderWeeklyTrendChart();
            createMonthFilter();
            createPersonFilter();
            renderDataTable();
            initYearSummarySelector();
        }

        // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
        document.getElementById('addDataModal').addEventListener('click', function(e) {
            if (e.target === this) closeAddDataModal();
        });
        document.getElementById('batchImportModal').addEventListener('click', function(e) {
            if (e.target === this) closeBatchImportModal();
        });
        document.getElementById('configModal').addEventListener('click', function(e) {
            if (e.target === this) closeConfigModal();
        });

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
